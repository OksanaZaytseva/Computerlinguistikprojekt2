# -*- coding: utf-8 -*-
"""Проект_2_ML.ipynb

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/1LJoD6Ur7b1jIetyL189AjD6YtjVNY2iK

# **Проект № 2 "Анализ тональности отзывов с сайта Кинопоиск с применением методов машинного обучения"**
"""

from google.colab import drive
drive.mount('/content/drive')

import pandas as pd
import numpy as np
import seaborn as sns
import matplotlib.pyplot as plt

!python -m spacy download ru_core_news_lg

from collections import Counter # необходимые импорты

from pymystem3 import Mystem
mystem = Mystem()

import re

import nltk

import spacy
nlp_rus = spacy.load("ru_core_news_lg")

add_stop_ne = []

with open('/content/drive/MyDrive/stop_ru (project).txt', 'r', encoding='utf-8') as f: #использую этот список для удаления стоп-слов
     add_stop_ne = [i.strip() for i in f]

print(len(add_stop_ne)) # 552
#print(add_stop_ne)

with open('/content/drive/MyDrive/MachineLearning /Project_2/Project_2_ner_list1.txt', 'r', encoding='utf-8') as f_ner:
  ner_list = [n.strip() for n in f_ner]
print(len(ner_list)) # 5283

ner_list

file = '/content/drive/MyDrive/MachineLearning /Project_2/Df_all_reviews.xlsx'
xl = pd.ExcelFile(file)
print(xl.sheet_names)

df = xl.parse('Sheet1')

df

#plt.figure(figsize=(15, 5))
plt.title("Распределение отзывов в корпусе")
plt.ylabel("Количество отзывов")
plt.xlabel("Класс")
plot = sns.countplot(data = df, x = 'Class', hue = 'Class', palette='Set3')

"""# **Word2Vec**

## ***Препроцессинг***
"""

def normalization(text): # препроцессинг для Word2Vec
    text = text.lower()
    text = re.sub('[0-9]+', 'num', text) # заменяем все числа
    text = text.replace('num из num', '')
    text = text.replace('num', '')
    text = re.sub('\\n', ' ', text)
    text = mystem.lemmatize(text)
    text = re.sub(r'\W', ' ', str(text)).split() # деление на токены
    text =  [usword for usword in list(text) if usword not in add_stop_ne] # удаляем стоп-слова
    return text

df['Clean_text'] = df['Text'].apply(normalization)

df

"""## ***Word2vec***"""

import gensim.models
from gensim.models import Word2Vec

# первая модель

model = Word2Vec(sentences = df['Clean_text'],
                min_count=5,
                 vector_size = 50)

model.wv.most_similar('фильм')

model.wv.most_similar('хороший')

model.wv.most_similar('великолепный')

model.wv.most_similar('интересный')

model.wv.most_similar('плохой')

model.wv.most_similar('глупый')

model.wv.most_similar('скучный')

model.wv.most_similar('ожидание')

model.wv.most_similar('эмоция')

model.wv.most_similar('впечатление')

# вторая модель

len(df['Clean_text'])

w2v_model = Word2Vec(min_count=5,
                     window=2,
                     sample=1e-5,
                     alpha=0.03,
                     min_alpha=0.0007,
                     negative=20)

w2v_model.build_vocab(df['Clean_text'])

w2v_model.corpus_count

# Commented out IPython magic to ensure Python compatibility.
# %%time
# w2v_model.train(df['Clean_text'], total_examples=w2v_model.corpus_count, epochs=50)

w2v_model.wv.most_similar('фильм')

w2v_model.wv.most_similar('хороший')

w2v_model.wv.most_similar('великолепный')

w2v_model.wv.most_similar('интересный')

w2v_model.wv.most_similar('плохой')

w2v_model.wv.most_similar('глупый')

w2v_model.wv.most_similar('скучный')

w2v_model.wv.most_similar('ожидание')

w2v_model.wv.most_similar('эмоция')

w2v_model.wv.most_similar('впечатление')

# третья модель

w2v_model_1 = Word2Vec(min_count=10,
                       window=2,
                       sample=6e-5,
                       alpha=0.03,
                       min_alpha=0.0007,
                       negative=10,
                       vector_size=300)

w2v_model_1.build_vocab(df['Clean_text'])

w2v_model_1.corpus_count

# Commented out IPython magic to ensure Python compatibility.
# %%time
# w2v_model_1.train(df['Clean_text'], total_examples=w2v_model_1.corpus_count, epochs=50)

w2v_model_1.wv.most_similar('фильм')

w2v_model_1.wv.most_similar('хороший')

w2v_model_1.wv.most_similar('великолепный')

w2v_model_1.wv.most_similar('интересный')

w2v_model_1.wv.most_similar('плохой')

w2v_model_1.wv.most_similar('глупый')

w2v_model_1.wv.most_similar('скучный')

w2v_model_1.wv.most_similar('ожидание')

w2v_model_1.wv.most_similar('эмоция')

w2v_model_1.wv.most_similar('впечатление')

"""# **Машинное обучение**

# ***Обучение на данных с препроцессингом***
"""

def preprocess_ML(text): # препроцессинг
    text = text.lower()
    text = re.sub('[a-zA-Z]', '', text) # уберем латиницу
    text = re.sub('[0-9]+', 'num', text) # заменим все числа
    text = text.replace('num из num', '')
    text = text.replace('num', '')
    text = re.sub('\\n', ' ', text)
    text = mystem.lemmatize(text)
    text = re.sub(r'\W', ' ', str(text)).split() # деление на токены
    text =  [wrd for wrd in text if wrd not in ner_list] # удаляем NER
    text =  [usword for usword in text if usword not in add_stop_ne] # удаляем стоп-слова
    #text =  [wrd for wrd in text if wrd not in ner_list] # удаляем NER
    #text = [w for w in text if len(w) >= 3] # удаляем слова короче 3-х символов
    result_text = ' '.join(text)
    return result_text

df['Text_lem'] = df['Text'].apply(preprocess_ML)

df

X = df['Text_lem']
y = df['Class'].tolist()

from sklearn.model_selection import train_test_split

X_train, X_test, y_train, y_test = train_test_split(X,
                                                    y,
                                                    stratify=y,
                                                    shuffle=True,
                                                    test_size=0.2,
                                                    random_state=42) # разделим выборку на тестовое и тренировочное множество

"""## ***Векторизация***"""

from sklearn.feature_extraction.text import CountVectorizer, TfidfVectorizer

"""**CountVectorizer**"""

count = CountVectorizer()

count.fit(X_train)

X_train_vec = count.transform(X_train)
X_test_vec =  count.transform(X_test)

"""**TF-IDF**"""

tf_idf = TfidfVectorizer()

tf_idf.fit(X_train)

X_train_tf_idf = tf_idf.transform(X_train)
X_test_tf_idf =  tf_idf.transform(X_test)

"""## ***LabelEncoder***"""

from sklearn.preprocessing import LabelEncoder

le = LabelEncoder()

le.fit(y_train)

le.classes_

y_train_le = le.transform(y_train)
y_test_le = le.transform(y_test)

"""## ***Классификация***"""

from sklearn.metrics import confusion_matrix, classification_report, ConfusionMatrixDisplay

"""## *MultinomialNB*"""

from sklearn.naive_bayes import MultinomialNB

"""### **CountVectorizer**"""

mnb = MultinomialNB()

mnb.fit(X_train_vec, y_train_le)

y_test_pred_mnb = mnb.predict(X_test_vec)

le.classes_

print(classification_report(y_test_le, y_test_pred_mnb, target_names=le.classes_))

cm_1 = confusion_matrix(y_test_le, y_test_pred_mnb)
cm_display_1 = ConfusionMatrixDisplay(cm_1, display_labels=le.classes_).plot()

"""### **TF-IDF**"""

mnb_tf = MultinomialNB()

mnb_tf.fit(X_train_tf_idf, y_train_le)

y_test_pred_mnb_tf = mnb_tf.predict(X_test_tf_idf)

print(classification_report(y_test_le, y_test_pred_mnb_tf, target_names=le.classes_))

cm_tf_idf = confusion_matrix(y_test_le, y_test_pred_mnb_tf)
cm_display_tf_idf = ConfusionMatrixDisplay(cm_tf_idf, display_labels=le.classes_).plot()

"""### ***Применение обученной модели на рандомных отзывах с сайта Кинопоиск***"""

from sklearn.pipeline import Pipeline

"""**CountVectorizer**"""

pipe = Pipeline([('count', CountVectorizer()),
                 ('mnb', MultinomialNB())])

pipe.fit(X, y)

# Фильм "Криминальное чтиво" (отзыв положительный)
film_1 = '''Культовый фильм одного из самых лучших режиссеров современности. Картина разошлась на цитаты и мемы по всему миру. Однако, чтобы после просмотра вы не пожалели о потраченном времени, нужно очень внимательно вслушиваться в каждый диалог, дабы уловить весь смысл происходящего на экране.
В первую очередь, стоит отметить, что Тарантино очень талантливо миксует комедию с преступлением, делая это через живые беседы главных героев. Лично для меня в этом и есть вся гениальность режиссера. Он высмеивает составляющую криминального мира, потешается над банальным стереотипным видом общения, будь то формальные ситуации или бытовые. В главных героях мы наблюдаем типовое поведение в различных обстановках, которое они превращают в черный юмор.

Огромный плюс кинокартины, что это не очередная бомбежка в друг друга, а очень хорошая гангстерская лента со своей философией, которая заложена буквально в каждой фразе. Именно поэтому фильм является одним из лучших в своем жанре. Кому-то он может показаться слишком нудным и длинным, и с большой вероятностью это будет из-за того, что лента не похожа на типичное криминальное кино. Здесь есть о чем подумать, поднимаются темы морали, верности, поиска себя и жизненного смысла.

Криминальное чтиво - это, безусловно, картина, которая является сплошным режиссерским почерком Квентина Тарантино. Особенно если вы не знакомы с творчеством данного режиссера, то этот шедевр вполне подойдет для знакомства с работами великого мастера криминальным драм. В киноленте он использует свои излюбленные приемы, такие как нижний ракурс или мексиканский тупик.

Резюмируя все вышесказанное, можно прийти к выводу, что данная картина - это вовсе не шаблонный фильм, в котором очень много эстетизации насилия и крови. Это очень интересная смесь юмора и иронии с кровавым постмодернистским боевиком.'''

film_clean_1 = preprocess_ML(film_1) # применим препроцессинг
film_clean_1

pipe.predict(['''
культовый фильм самый хороший режиссер современность картина расходиться цитата мема мир просмотр не пожалеть потратить очень внимательно вслушиваться диалог дабы улавливать смысл происходить экран очередь стоить отмечать очень талантливо миксовать комедия преступление делать живой беседа главный герой лично гениальность режиссер высмеивать составлять криминальный мир потешаться банальный стереотипный вид общение формальный ситуация бытовой главный герой наблюдать типовой поведение различный обстановка превращать черный юмор огромный плюс кинокартина не очередной бомбежка друг друг очень хороший гангстерский лента философия закладывать буквально фраза поэтому фильм являться хороший жанр показываться нудный длинный большой вероятность лента не похожий типичный криминальный кино подумать подниматься тема мораль верность поиск жизненный смысл криминальный чтиво безусловно картина являться сплошной режиссерский почерк особенно не знакомый творчество данный режиссер шедевр вполне подходить знакомство работа великий мастер криминальный драма кинолента использовать излюбленный прием нижний ракурс мексиканский тупик резюмировать вышесказанный приходить вывод данный картина вовсе не шаблонный фильм очень эстетизация насилие кровь очень интересный смесь юмор ирония кровавый постмодернистский боевик
'''])

# Фильм "Король говорит" (отзыв отрицательный)
film_2 = '''
Боже, какой унылый фильм и слов нет выразить.

Начну с самого начала. Том Хупер, режиссер таких картин как 'Отверженные', 'Проклятый Юнайтед', попытается нас пронести сквозь историю из жизни короля Георга VI, где он собственно становится королем. Чем же так примечателен этот отрезок жизни, и в чем собственно драма фильма? Где конфликт, о чем мать его этот фильм??

Режиссер пытается передать всю тяжесть и ношу проблем Георга, а именно речевые дефекты, заикания. Бедному королю пришлось пережить такую проблему, ему пришлось проводить уроки у логопеда, о ужас! Представляете? Он прошел немало учителей, но нашел вдруг хорошего, который заставил хорошенько потренироваться бедного короля, у которого так много дел.. например подписывать бумаги по просьбе премьер-министра.

Чуть не забыл, в фильме же еще есть другая линия сюжета, это конфликт с братом. А точнее его отсутствие... великая проблема брата в том, что он хочет женится на девушке легкого поведения... вот это драма! И по собственному желанию передает престол своему любимому брату, это происходит без крови и скандалов, но режиссер почему то предлагает нам смотреть на это как на какую-то трагедию... волнующая музыка... медленно протекающий сюжет о том, как брат очень медленно становится королем, не желая этого. Вот так проблема.

Не обошлось и без упоминаний о трудном детстве где няня щипала и голодом морила бедняжку и что брат тролил, да вот только человек вырос здоровым, а отношения с братом стали крепкими, что как бы намекает что все эти жалобы - сущее нытье.. В общем не жизнь, а трагедия. Любящая красавица жена, огромные замки, статус короля, красивые дети, роскошь и имущество, все это ничто по сравнению с дефектами речи и проблемой, что придется брать ответственность брата на себя. В конце оказалось, что все же тренировки прошли не так плохо и он таки преодолел. Кульминация.

Вся приятная картинка этого фильма - отличные актеры, которые могут выжить из себя слезинку, да красивые локации. ГДЕ сюжет? ГДЕ история? Ради чего мы все тут собрались? Непонятно.

В общем фильм отстой редкостный, сначала я пожалел о потраченном времени, и даже не хотел тратить время на рецензию. Но позже, когда я увидел 4 оскара, imdb 8, понял что все таки этот фильм учит многому. Тому, что оскар не всегда прав, бывает политическим, не знаю как но даже рейтинги могут быть смещены, некими силами. Возможно проплаченными журналами или еще чем-то, но их можно сместить. Этот фильм напомнил мне фильм 'темные времена', которые тоже был таким же унылыми английским детищем, где просто обсасывалась фигура Черчилля, мол какой он хороший. Я тогда тоже подумал, что явно госзаказ какой-то, приподнять патриотизм народа.

Короче твердая шестерка этому фильму и валеты на погоны Хупера.
'''

film_clean_2 = preprocess_ML(film_2) # применим препроцессинг
film_clean_2

pipe.predict(['''
боже унылый фильм слово нет выражать начинать самый начало режиссер картина отверженный проклятый юнайтед попытаться пронести сквозь история король собственно становиться король примечательный отрезок собственно драма фильм конфликт мать фильм режиссер пытаться передавать тяжесть носить проблема речевой дефект заикание бедный король приходиться переживать проблема приходиться проводить урок логопед ужас представлять проходить немало учитель находить хороший заставлять хорошенько потренироваться бедный король дело например подписывать бумага просьба премьер министр не забывать фильм линия сюжет конфликт брат точно отсутствие великий проблема брат жениться девушка легкий поведение драма собственный желание передавать престол любимый брат происходить без кровь скандал режиссер предлагать смотреть трагедия волнующий музыка медленно протекать сюжет брат очень медленно становиться король не желать проблема не обходиться без упоминание трудный детство няня щипать голод морить бедняжка брат троливать вырастать здоровый отношение брат становиться крепкий намекать жалоба сущий нытье общий не трагедия любить красавица жена огромный замок статус король красивый ребенок роскошь имущество ничто сравнение дефект речь проблема приходиться брать ответственность брат конец оказываться тренировка проходить не плохой таки преодолевать кульминация приятный картинка фильм отличный актер выживать слезинка красивый локация сюжет история ради собираться непонятный общий фильм отстоять редкостный пожалеть потратить не тратить рецензия поздно увидеть понимать таки фильм учить многое не правый бывать политический не знать рейтинг смещать некий сила возможно проплачивать журнал смещать фильм напоминать фильм темный унылый английский детище обсасываться фигура черчилль мол хороший подумать явно госзаказ приподымать патриотизм народ короче твердый шестерка фильм валет погон
'''])

# Сериал "Уэнсдэй" (отзыв положительный)
film_3 =  '''

Тот случай, когда результат превзошел ожидания. Хотя сразу стоит уточнить, что ждал я совсем немногого - первый трейлер не внушал особого доверия и обещал еще один сериал в духе 'Приключений Сабрины'. Что ж, приятно порой ошибиться: на выходе я получил незатейливую, но местами интересную историю с очаровательной главной героиней.

В 'Уэнсдей' полно косяков и недочетов, но на каждый минус найдется плюс. Деревянная, скучная и совершенно неубедительная Кетрин Зета Джонс в роли Мортиши? Ну и что, зато есть великолепная Ортега и крайне милый (несмотря на свою специфическую внешность) Луис Гусман (а еще Вещь и Дядя Фестер!). Пятиминутные подростковые любовные треугольники? Потерпим, ведь гораздо интереснее следить за эволюцией взаимоотношений Уэнсдей и Энид на протяжении всех восьми серий с очень трогательным финалом в последней. Куда уж там 7й серии 'Одних из нас'.

Главным же минусом сериала для меня стало отсутствие интриги. Личины злодеев угадываешь уже к пятой серии - слишком много жирных, очевидных подсказок. Это, конечно, прилично смазало впечатление от последних серий.

Однако после просмотра всё равно остается приятное послевкусие: в памяти застревают красивые планы, замысловатые декорации, интересные костюмы и приятный уху саундтрек. Но весь это аудио-визуальный фон, разумеется, не имел бы особого значения без грамотно прописанной главной героини в центре повествования. На протяжении восьми серий мы наблюдаем за взаимоотношениями Уэнсдей с её семьей и новыми знакомыми. Персонаж проходит длинный путь от замкнутого эгоистичного социфоба до человека, способного на самопожертвование во имя дружбы. Такому превращению веришь, это здорово.

И пусть часть персонажей не раскрыли, толком не рассказали про школьные группировки и уроки (это же школа, блин, кроме фехтования и растениеводства должно же еще что-то быть), а пару сюжетных веток вообще забросили на полпути (видимо, отложив их на второй сезон) - на пять часов я провалился в атмосферу подросткового фэнтези, испытав эмоции схожие с прочтением 'Ордена Феникса' в 14-летнем возрасте. Это чего-то да стоит.

'''

film_clean_3 = preprocess_ML(film_3) # применим препроцессинг
film_clean_3

# Сериал "Уэнсдэй" (отзыв положительный)
pipe.predict(['''
случай результат превосходить ожидание сразу стоить уточнять ждать совсем немногое трейлер не внушать особый доверие обещать сериал дух приключение сабрина приятно ошибаться выход получать незатейливый место интересный история очаровательный главный героиня уэнсдей полно косяк недочет минус находиться плюс деревянный скучный совершенно неубедительный зет роль мортиша великолепный ортег крайне милый несмотря специфический внешность гусман вещь дядя фестер пятиминутный подростковый любовный треугольник потерпеть гораздо интересно следить эволюция взаимоотношение уэнсдей эниды протяжение серия очень трогательный финал последний й серия главный минус сериал становиться отсутствие интрига личина злодей угадывать серия жирный очевидный подсказка прилично смазывать впечатление последний серия просмотр равный оставаться приятный послевкусие память застревать красивый план замысловатый декорация интересный костюм приятный ухо саундтрек аудио визуальный разумеется не особый значение без грамотно прописывать главный героиня центр повествование протяжение серия наблюдать взаимоотношение уэнсдей семья новый знакомый персонаж проходить длинный путь замкнутый эгоистичный социфоб способный самопожертвование дружба превращение верить здорово пусть часть персонаж не раскрывать толком не рассказывать школьный группировка урок школа блин фехтование растениеводство пара сюжетный ветка вообще забросить полпути видимо откладывать сезон час проваливаться атмосфера подростковый фэнтези испытывать эмоция схожий прочтение орден феникс летний возраст стоять
'''])

# Фильм "Грязные танцы" (отзыв отрицательный)
film_4 =  '''
Мне кажется, это больше девчоночий фильм, причем не самый лучший.
Танец - это красиво и сексуально, но все остальное - сплошной примитив, начиная от самого сюжета, заканчивая его развитием. Но посмотреть можно. Просто не цепляет. По крайней мере, таково мое мнение...
'''

film_clean_4 = preprocess_ML(film_4) # применим препроцессинг
film_clean_4

pipe.predict(['''казаться девчоночий фильм причем не самый хороший танец красивый сексуально остальное сплошной примитив начинать самый сюжет заканчивать развитие посмотреть не цеплять крайний мера таков мнение
'''
])

"""**TF-IDF**"""

pipe_tf = Pipeline([('tf_idf', TfidfVectorizer()),
                 ('mnb_tf', MultinomialNB())])

pipe_tf.fit(X, y)

# Фильм "Криминальное чтиво" (отзыв положительный)
pipe_tf.predict(['''
культовый фильм самый хороший режиссер современность картина расходиться цитата мема мир просмотр не пожалеть потратить очень внимательно вслушиваться диалог дабы улавливать смысл происходить экран очередь стоить отмечать очень талантливо миксовать комедия преступление делать живой беседа главный герой лично гениальность режиссер высмеивать составлять криминальный мир потешаться банальный стереотипный вид общение формальный ситуация бытовой главный герой наблюдать типовой поведение различный обстановка превращать черный юмор огромный плюс кинокартина не очередной бомбежка друг друг очень хороший гангстерский лента философия закладывать буквально фраза поэтому фильм являться хороший жанр показываться нудный длинный большой вероятность лента не похожий типичный криминальный кино подумать подниматься тема мораль верность поиск жизненный смысл криминальный чтиво безусловно картина являться сплошной режиссерский почерк особенно не знакомый творчество данный режиссер шедевр вполне подходить знакомство работа великий мастер криминальный драма кинолента использовать излюбленный прием нижний ракурс мексиканский тупик резюмировать вышесказанный приходить вывод данный картина вовсе не шаблонный фильм очень эстетизация насилие кровь очень интересный смесь юмор ирония кровавый постмодернистский боевик
'''])

# Фильм "Король говорит" (отзыв отрицательный)
pipe_tf.predict(['''
боже унылый фильм слово нет выражать начинать самый начало режиссер картина отверженный проклятый юнайтед попытаться пронести сквозь история король собственно становиться король примечательный отрезок собственно драма фильм конфликт мать фильм режиссер пытаться передавать тяжесть носить проблема речевой дефект заикание бедный король приходиться переживать проблема приходиться проводить урок логопед ужас представлять проходить немало учитель находить хороший заставлять хорошенько потренироваться бедный король дело например подписывать бумага просьба премьер министр не забывать фильм линия сюжет конфликт брат точно отсутствие великий проблема брат жениться девушка легкий поведение драма собственный желание передавать престол любимый брат происходить без кровь скандал режиссер предлагать смотреть трагедия волнующий музыка медленно протекать сюжет брат очень медленно становиться король не желать проблема не обходиться без упоминание трудный детство няня щипать голод морить бедняжка брат троливать вырастать здоровый отношение брат становиться крепкий намекать жалоба сущий нытье общий не трагедия любить красавица жена огромный замок статус король красивый ребенок роскошь имущество ничто сравнение дефект речь проблема приходиться брать ответственность брат конец оказываться тренировка проходить не плохой таки преодолевать кульминация приятный картинка фильм отличный актер выживать слезинка красивый локация сюжет история ради собираться непонятный общий фильм отстоять редкостный пожалеть потратить не тратить рецензия поздно увидеть понимать таки фильм учить многое не правый бывать политический не знать рейтинг смещать некий сила возможно проплачивать журнал смещать фильм напоминать фильм темный унылый английский детище обсасываться фигура черчилль мол хороший подумать явно госзаказ приподымать патриотизм народ короче твердый шестерка фильм валет погон
'''])

# Сериал "Уэнсдэй" (отзыв положительный)
pipe_tf.predict(['''
случай результат превосходить ожидание сразу стоить уточнять ждать совсем немногое трейлер не внушать особый доверие обещать сериал дух приключение сабрина приятно ошибаться выход получать незатейливый место интересный история очаровательный главный героиня уэнсдей полно косяк недочет минус находиться плюс деревянный скучный совершенно неубедительный зет роль мортиша великолепный ортег крайне милый несмотря специфический внешность гусман вещь дядя фестер пятиминутный подростковый любовный треугольник потерпеть гораздо интересно следить эволюция взаимоотношение уэнсдей эниды протяжение серия очень трогательный финал последний й серия главный минус сериал становиться отсутствие интрига личина злодей угадывать серия жирный очевидный подсказка прилично смазывать впечатление последний серия просмотр равный оставаться приятный послевкусие память застревать красивый план замысловатый декорация интересный костюм приятный ухо саундтрек аудио визуальный разумеется не особый значение без грамотно прописывать главный героиня центр повествование протяжение серия наблюдать взаимоотношение уэнсдей семья новый знакомый персонаж проходить длинный путь замкнутый эгоистичный социфоб способный самопожертвование дружба превращение верить здорово пусть часть персонаж не раскрывать толком не рассказывать школьный группировка урок школа блин фехтование растениеводство пара сюжетный ветка вообще забросить полпути видимо откладывать сезон час проваливаться атмосфера подростковый фэнтези испытывать эмоция схожий прочтение орден феникс летний возраст стоять
'''])

# Фильм "Грязные танцы" (отзыв отрицательный)
pipe_tf.predict(['''
казаться девчоночий фильм причем не самый хороший танец красивый сексуально остальное сплошной примитив начинать самый сюжет заканчивать развитие посмотреть не цеплять крайний мера таков мнение
'''])

"""**Вывод:**


1.   MultinomialNB с предобработанными и векторизованными CountVectorizer данными дает хорошие метрики — weighted avg F1 равен 0,84, recall положительных отзывов равен 0,85. У обученной модели хорошая предсказательная способность — безошибочно определила тональность рандомных отзывов.
2.   У модели MultinomialNB с предобработанными и векторизованными TF-IDF данными метрики хуже — weighted avg F1 равен 0,83, но при этом recall положительных отзывов равен 0,77. Модель ошиблась в определении тональности положительного отзыва, указав, что он отрицательный.

## *Логистическая регрессия*
"""

from sklearn.linear_model import LogisticRegression

"""### **CountVectorizer**"""

log_clf = LogisticRegression(random_state=0, max_iter=1000)

log_clf.fit(X_train_vec, y_train_le)

y_pred_lg = log_clf.predict(X_test_vec)

print(classification_report(y_test_le, y_pred_lg, target_names = le.classes_))

cm_lg_1 = confusion_matrix(y_test_le, y_pred_lg)
cm_display_lg = ConfusionMatrixDisplay(cm_lg_1, display_labels=le.classes_).plot()

"""**“Важные” для каждого класса слова по коэффициентам (CountVectorizer)**"""

feature_names = count.get_feature_names_out()

feature_names

feature_names.shape

log_clf.coef_.shape

features_df_binary = pd.DataFrame()
features_df_binary['term'] = feature_names
features_df_binary['coef'] = log_clf.coef_[0]

coefficients_binary = features_df_binary.sort_values(by='coef', ascending=False).reset_index(drop=True)

coefficients_binary[:25]

coefficients_binary[26880:26905]

"""Балансировка весов"""

clf_ovr = LogisticRegression(max_iter=1000, random_state=42, multi_class='ovr', class_weight='balanced')

clf_ovr.fit(X_train_vec, y_train_le)

y_test_pred_lg_ovr = clf_ovr.predict(X_test_vec)

print(classification_report(y_test_le, y_test_pred_lg_ovr, target_names=le.classes_))

cm_lg_ovr = confusion_matrix(y_test_le, y_test_pred_lg_ovr)
cm_display_lg_ovr = ConfusionMatrixDisplay(cm_lg_ovr, display_labels=le.classes_).plot()

"""### **TF-IDF**"""

log_clf_tf = LogisticRegression(random_state=0, max_iter=1000)

log_clf_tf.fit(X_train_tf_idf, y_train_le)

y_pred_lg_tf = log_clf_tf.predict(X_test_tf_idf)

print(classification_report(y_test_le, y_pred_lg_tf , target_names = le.classes_))

cm_lg_tf = confusion_matrix(y_test_le, y_pred_lg_tf)
cm_display_lg_tf = ConfusionMatrixDisplay(cm_lg_tf, display_labels=le.classes_).plot()

"""**“Важные” для каждого класса слова по коэффициентам**"""

feature_names_tf = tf_idf.get_feature_names_out()

feature_names_tf

feature_names_tf.shape

log_clf_tf.coef_.shape

features_df_binary_tf = pd.DataFrame()
features_df_binary_tf['term'] = feature_names_tf
features_df_binary_tf['coef'] = log_clf_tf.coef_[0]

coefficients_binary_tf = features_df_binary_tf.sort_values(by='coef', ascending=False).reset_index(drop=True)

coefficients_binary_tf[:25]

coefficients_binary_tf[26880:26905]

"""### **Применение обученной модели на рандомных отзывах с сайта Кинопоиск**

**CountVectorizer**
"""

pipe_lg_vec = Pipeline([('count', CountVectorizer()),
                 ('log_clf', LogisticRegression(max_iter=1000))])

pipe_lg_vec.fit(X, y)

# Фильм "Список Шиндлера" (отзыв положительный)
film_5 = '''
Великий фильм. Он не просто фильм, а шедевр мирового кинематографа. А именно так, подобно роману 'Война и мир' и другим величайшим произведениям, которые останутся монументами человечества.

Пройдут века и возможно людей не будет, но эти памятники будут жить не смотря ни на что...

Оскар Шиндлер - простой и умный предприниматель и ему нужны только деньги, но когда он видит весь ужас гитлеровщины и свирепые массовые казни над евреями, его внутренний мир меняется - душа его понимает, что он виноват, душа ему говорит, что нужно помочь людям. Вот вопрос. Как жесток человек?!

Все - таки духовно-нравственных людей мало на Земле и они достойны быть избранными.

Посмотрите вокруг, сколько гадости везде и, зло творится. И только духовно-нравственные люди могут хоть как-то повлиять на изменения баланса добра и зла. Оскар - это человек великой человеческой натуры, о которых писали гуманисты веками. Фильм = показ нам всем землянам, что добро есть и оно будет.
'''

film_clean_5 = preprocess_ML(film_5) # применим препроцессинг
film_clean_5

pipe_lg_vec.predict(['''
великий фильм не фильм шедевр мировой кинематограф подобно роман война мир великий произведение оставаться монумент человечество проходить век возможно не памятник жить не смотря ни простой умный предприниматель нужный деньги видеть ужас гитлеровщина свирепый массовый казнь еврей внутренний мир меняться душа понимать виноватый душа говорить помогать вопрос жестокий таки духовно нравственный достойный избранный посмотреть гадость зло твориться духовно нравственный повлиять изменение баланс добро зло великий человеческий натура писать гуманист век фильм показ землянин добро'''])

# Фильм "Запах женщины" (отзыв отрицательный)
film_6 = '''

Основой сюжета стало изображение взаимоотношений пожилого незрячего полковника и очень молодого студента колледжа. Студент является ребёнком из небогатой семьи и решается подработать по сути поводырём к незрячему военному. И тут начинаются малоприятные события. Стоит сказать, что сам полковник является довольно сварливым и пошлым субъектом, которому уже стало попросту скучно жить свою жизнь. Также и у студента возникли проблемы с обучением, а именно риск потерять своё место в колледже не бюджете. А всё из-за того, что парень стал невольным свидетелем хулиганства своих якобы друзей.

Но это всё зачин. Основной хронометраж будет посвящён именно полковнику и тому, как он подвергает опасности жизнь других людей. Это грустно смотреть на фоне другого фильма, который показывает тяжесть существования простых солдат. То есть в сравнении с той же 'Первой кровью' жизни военных разных званий разительно отличаются. Если офицеры буквально сорят деньгами на сомнительные цели, то солдаты буквально ночуют на улице без возможности даже поесть в обычном кафе и найти самую обычную работу. Стоит ещё сказать, что в своей инвалидности по сути сам полковник и виноват. Тут уж можно ощутить лишь сплошное недоумение. Весь фильм был отсмотрен с этим недоумением. Финал так вообще поверг в шок, что из-за нежелания сотрудничать с директором. Студент мог вообще потерять своё место. Это просто ни в какие ворота. Притом видно, что студент способный и не зря получил свою стипендию. А тут возникает риск потери места по надуманной причине.

Речь полковника в финале так же не заставила его уважать. Всё обыденно и прозаично. А ведь ожидания были высокие, что речь заставит хулиганов самих признаться в содеянном и выглядеть большими мужчинами. Но этого не произошло. Были так же ожидания, что полковник окажется хотя бы умудрённым жизнью романтиком, который знает цену слабому полу. Но и это ожидание рухнуло под натиском прозаичной реальности. Престарелый ветеран оказался обычным пошляком.

По итогу, фильм оказался переоценённым затянутым полотном про жизнь одним днём без каких-либо мыслей о безопасности ближнего.
'''

film_clean_6 = preprocess_ML(film_6) # применим препроцессинг
film_clean_6

pipe_lg_vec.predict(['''
основа сюжет становиться изображение взаимоотношение пожилой незрячий полковник очень молодой студент колледж студент являться ребенок небогатый семья решаться подрабатывать поводырь незрячий военный начинаться малоприятный событие стоять полковник являться сварливый пошлый субъект становиться попросту скучно жить студент возникать проблема обучение риск потерять место колледж не бюджет парень становиться невольный свидетель хулиганство якобы друг зачин основной хронометраж посвящать полковник подвергать опасность грустно смотреть фильм показывать тяжесть существование простой солдат сравнение кровь военный разный звание разительный отличаться офицер буквально сорить деньги сомнительный цель солдат буквально ночевать улица без возможность поесть обычный кафе находить самый обычный работа стоить инвалидность полковник виноватый ощущать сплошной недоумение фильм отсмотреть недоумение финал вообще повергать шок нежелание сотрудничать директор студент вообще потерять место ни ворота притом видный студент способный не зря получать стипендия возникать риск потеря место надуманный причина речь полковник финал не заставлять уважать обыденно прозаичный ожидание высокий речь заставлять хулиган признаваться содеять выглядеть большой мужчина не происходить ожидание полковник оказываться умудрять романтик знать цена слабый пол ожидание рухнуть натиск прозаичный реальность престарелый ветеран оказываться обычный пошляк итог фильм оказываться переоценивать затянутый полотно без либо мысль безопасность ближний
'''])

"""**TF-IDF**"""

pipe_lg_tf = Pipeline([('tf_idf', TfidfVectorizer()),
                 ('log_clf_tf ', LogisticRegression(max_iter=1000))])

pipe_lg_tf.fit(X, y)

# Фильм "Список Шиндлера" (отзыв положительный)
pipe_lg_tf.predict(['''
великий фильм не фильм шедевр мировой кинематограф подобно роман война мир великий произведение оставаться монумент человечество проходить век возможно не памятник жить не смотря ни простой умный предприниматель нужный деньги видеть ужас гитлеровщина свирепый массовый казнь еврей внутренний мир меняться душа понимать виноватый душа говорить помогать вопрос жестокий таки духовно нравственный достойный избранный посмотреть гадость зло твориться духовно нравственный повлиять изменение баланс добро зло великий человеческий натура писать гуманист век фильм показ землянин добро
'''])

# Фильм "Запах женщины" (отзыв отрицательный)
pipe_lg_tf.predict(['''
основа сюжет становиться изображение взаимоотношение пожилой незрячий полковник очень молодой студент колледж студент являться ребенок небогатый семья решаться подрабатывать поводырь незрячий военный начинаться малоприятный событие стоять полковник являться сварливый пошлый субъект становиться попросту скучно жить студент возникать проблема обучение риск потерять место колледж не бюджет парень становиться невольный свидетель хулиганство якобы друг зачин основной хронометраж посвящать полковник подвергать опасность грустно смотреть фильм показывать тяжесть существование простой солдат сравнение кровь военный разный звание разительный отличаться офицер буквально сорить деньги сомнительный цель солдат буквально ночевать улица без возможность поесть обычный кафе находить самый обычный работа стоить инвалидность полковник виноватый ощущать сплошной недоумение фильм отсмотреть недоумение финал вообще повергать шок нежелание сотрудничать директор студент вообще потерять место ни ворота притом видный студент способный не зря получать стипендия возникать риск потеря место надуманный причина речь полковник финал не заставлять уважать обыденно прозаичный ожидание высокий речь заставлять хулиган признаваться содеять выглядеть большой мужчина не происходить ожидание полковник оказываться умудрять романтик знать цена слабый пол ожидание рухнуть натиск прозаичный реальность престарелый ветеран оказываться обычный пошляк итог фильм оказываться переоценивать затянутый полотно без либо мысль безопасность ближний
'''])

# Проверю, как модель оценит отзыв (положительный) на сериал "Уэнсдэй", который модель MultinomialNB с TF-IDF отнесла к отрицательным.
pipe_lg_tf.predict(['''
случай результат превосходить ожидание сразу стоить уточнять ждать совсем немногое трейлер не внушать особый доверие обещать сериал дух приключение сабрина приятно ошибаться выход получать незатейливый место интересный история очаровательный главный героиня уэнсдей полно косяк недочет минус находиться плюс деревянный скучный совершенно неубедительный зет роль мортиша великолепный ортег крайне милый несмотря специфический внешность гусман вещь дядя фестер пятиминутный подростковый любовный треугольник потерпеть гораздо интересно следить эволюция взаимоотношение уэнсдей эниды протяжение серия очень трогательный финал последний й серия главный минус сериал становиться отсутствие интрига личина злодей угадывать серия жирный очевидный подсказка прилично смазывать впечатление последний серия просмотр равный оставаться приятный послевкусие память застревать красивый план замысловатый декорация интересный костюм приятный ухо саундтрек аудио визуальный разумеется не особый значение без грамотно прописывать главный героиня центр повествование протяжение серия наблюдать взаимоотношение уэнсдей семья новый знакомый персонаж проходить длинный путь замкнутый эгоистичный социфоб способный самопожертвование дружба превращение верить здорово пусть часть персонаж не раскрывать толком не рассказывать школьный группировка урок школа блин фехтование растениеводство пара сюжетный ветка вообще забросить полпути видимо откладывать сезон час проваливаться атмосфера подростковый фэнтези испытывать эмоция схожий прочтение орден феникс летний возраст стоять
'''])

"""**Интересный случай**"""

# Фильм "Список Шиндлера" (отзыв отрицательный)
film_int_case = '''
В целом трагедия, переданная режиссёром в том фильме, понятна и ясна, однако не благодаря этому фильму.

Очень хотелось бы сопереживать хоть кому-то из персонажей, однако главным героем в данной картине выступает промышленник Шиндлер, которого воспринимаешь как простого прагматика, который хоть и является человеком 'великодушным', но тем не менее исходящем из необходимости построить производство используя крайне дешёвую и даже рабскую рабочую силу еврейского населения Кракова. Ицхак Штерн, в данном фильме сыграл, без лишних слов, выше всяких похвал. Но это пожалуй относится именно к актёрской игре, а не к наполнению картины.

Стоит обратить внимание на цветовую палитру фильма, который хоть и выдержан в откровенно черно-белых тонах, но тем не менее ряд персонажей всё же подсвечен яркими красками. С другой стороны не совсем понятно чем это обусловлено. Почему эти персонажи выделены, ведь кроме главного героя и его управляющего, сопереживать здесь просто некому. По крайней мере я для себя такого персонажа так и не нашёл.

Да, происходящее ужасно, но есть фильмы где это передано куда лучше. Допустим 'Жизнь прекрасна'. Этот художественный фильм, решает вопрос передачи 'духа времени' в художественном плане куда лучше. Со 'Списком Шиндлера' всё становится ясно уже после часа просмотра, когда ты понимаешь, что ты смотреть его уже устал, но тебе придётся наблюдать это действо ещё два часа.

Или же фильм 'Бункер', где ты наблюдаешь действие в течении всей ленты и даже не задумываешься о хронометраже, ведь каждую минуту что-то происходит.

В качестве вывода скажу следующее. Не каждый фильм из 'Топ 250', судя по всему заслуживает просмотра. Не каждый фильм, который получил кучу 'Оскаров', достоин вашего времени.

Не хватает всего, сюжета, динамики сопереживания. Да и я не помню случаев, когда нацисты строили свои поместья рядом с концлагерями. Это очень странное решение, учитывая факты описанные Уильямом Ширером, который указывает на тот факт, что сами нацисты стремились привлекать коллаборантов или же наиболее отмороженных нацистов к ликвидации еврейского, цыганского и советского народов. Ещё одно странное решение - держать собак в намордниках, когда проводят еврейский конвой. Наоборот - стоило бы дать возможность собакам сделать своё дело, ведь так было бы достовернее.

Что же касается прочих особенностей - актёры действительно играют хорошо. Нацисты действительно внушают страх, евреи в фильме этот страх поглощают и всем им веришь.

Картинка очень классная. Операторская работа и звук, как и всё звуковое оформление, на очень высоком уровне. Концовка очень трогательная, но то, как показали одного советского солдата, спускает всё повествование в унитаз. Сам фильм очень сильно проседает по мере всего повествования. По этой причине я даю такое резюме: это просто очередное кино о войне, в котором авторы не забыли в одной сцене(!) нагадить на голову Советскому Союзу.

Я бы не стал его советовать к просмотру.
'''

film_int_case_clean = preprocess_ML(film_int_case) # применим препроцессинг
film_int_case_clean

# Предсказание Logistic Regression с CountVectorizer
pipe_lg_vec.predict(['''
целое трагедия передавать режиссер фильм понятный ясный не благодаря фильм очень хотеться сопереживать персонаж главный герой данный картина выступать промышленник воспринимать простой прагматик являться великодушный не менее исходить необходимость построить производство использовать крайне дешевый рабский рабочий сила еврейский население краков ицхак штерн данный фильм сыграть без лишний слово высоко всякий похвала пожалуй относиться актерский игра не наполнение картина стоить обращать внимание цветовой палитра фильм выдерживать откровенно черно белый тон не менее ряд персонаж подсвечивать яркий краска сторона не совсем понятно обусловливать персонаж выделять главный герой управлять сопереживать некого крайний мера персонаж не находить происходить ужасный фильм передавать допускать прекрасный художественный фильм решать вопрос передача дух художественный план список становиться ясно час просмотр понимать смотреть уставать приходиться наблюдать действо час фильм бункер наблюдать действие течение лента не задумываться хронометраж минута происходить качество вывод следующий не фильм топ судя заслуживать просмотр не фильм получать куча достойный не хватать сюжет динамика сопереживание не помнить случай нацист строить поместье концлагерь очень странный решение учитывать факт описывать уильям ширер указывать факт нацист стремиться привлекать коллаборант наиболее отмораживать нацист ликвидация еврейский цыганский советский народ странный решение держать собака намордник проводить еврейский конвой наоборот стоить давать возможность собака сделать дело достоверно касаться прочий особенность актер играть нацист внушать страх еврей фильм страх поглощать верить картинка очень классный операторский работа звук звуковой оформление очень высокий уровень концовка очень трогательный показывать советский солдат спускать повествование унитаз фильм очень сильно проседать мера повествование причина давать резюме очередной кино война автор не забывать сцена нагадить голова советский не становиться советовать просмотр
'''])

# Предсказание MultinomialNB с CountVectorizer
pipe.predict(['''
целое трагедия передавать режиссер фильм понятный ясный не благодаря фильм очень хотеться сопереживать персонаж главный герой данный картина выступать промышленник воспринимать простой прагматик являться великодушный не менее исходить необходимость построить производство использовать крайне дешевый рабский рабочий сила еврейский население краков ицхак штерн данный фильм сыграть без лишний слово высоко всякий похвала пожалуй относиться актерский игра не наполнение картина стоить обращать внимание цветовой палитра фильм выдерживать откровенно черно белый тон не менее ряд персонаж подсвечивать яркий краска сторона не совсем понятно обусловливать персонаж выделять главный герой управлять сопереживать некого крайний мера персонаж не находить происходить ужасный фильм передавать допускать прекрасный художественный фильм решать вопрос передача дух художественный план список становиться ясно час просмотр понимать смотреть уставать приходиться наблюдать действо час фильм бункер наблюдать действие течение лента не задумываться хронометраж минута происходить качество вывод следующий не фильм топ судя заслуживать просмотр не фильм получать куча достойный не хватать сюжет динамика сопереживание не помнить случай нацист строить поместье концлагерь очень странный решение учитывать факт описывать уильям ширер указывать факт нацист стремиться привлекать коллаборант наиболее отмораживать нацист ликвидация еврейский цыганский советский народ странный решение держать собака намордник проводить еврейский конвой наоборот стоить давать возможность собака сделать дело достоверно касаться прочий особенность актер играть нацист внушать страх еврей фильм страх поглощать верить картинка очень классный операторский работа звук звуковой оформление очень высокий уровень концовка очень трогательный показывать советский солдат спускать повествование унитаз фильм очень сильно проседать мера повествование причина давать резюме очередной кино война автор не забывать сцена нагадить голова советский не становиться советовать просмотр
'''])

# Предсказание Logistic Regression с TF-IDF
pipe_lg_tf.predict(['''
целое трагедия передавать режиссер фильм понятный ясный не благодаря фильм очень хотеться сопереживать персонаж главный герой данный картина выступать промышленник воспринимать простой прагматик являться великодушный не менее исходить необходимость построить производство использовать крайне дешевый рабский рабочий сила еврейский население краков ицхак штерн данный фильм сыграть без лишний слово высоко всякий похвала пожалуй относиться актерский игра не наполнение картина стоить обращать внимание цветовой палитра фильм выдерживать откровенно черно белый тон не менее ряд персонаж подсвечивать яркий краска сторона не совсем понятно обусловливать персонаж выделять главный герой управлять сопереживать некого крайний мера персонаж не находить происходить ужасный фильм передавать допускать прекрасный художественный фильм решать вопрос передача дух художественный план список становиться ясно час просмотр понимать смотреть уставать приходиться наблюдать действо час фильм бункер наблюдать действие течение лента не задумываться хронометраж минута происходить качество вывод следующий не фильм топ судя заслуживать просмотр не фильм получать куча достойный не хватать сюжет динамика сопереживание не помнить случай нацист строить поместье концлагерь очень странный решение учитывать факт описывать уильям ширер указывать факт нацист стремиться привлекать коллаборант наиболее отмораживать нацист ликвидация еврейский цыганский советский народ странный решение держать собака намордник проводить еврейский конвой наоборот стоить давать возможность собака сделать дело достоверно касаться прочий особенность актер играть нацист внушать страх еврей фильм страх поглощать верить картинка очень классный операторский работа звук звуковой оформление очень высокий уровень концовка очень трогательный показывать советский солдат спускать повествование унитаз фильм очень сильно проседать мера повествование причина давать резюме очередной кино война автор не забывать сцена нагадить голова советский не становиться советовать просмотр
'''])

# Предсказание MultinomialNB с TF-IDF
pipe_tf.predict(['''
целое трагедия передавать режиссер фильм понятный ясный не благодаря фильм очень хотеться сопереживать персонаж главный герой данный картина выступать промышленник воспринимать простой прагматик являться великодушный не менее исходить необходимость построить производство использовать крайне дешевый рабский рабочий сила еврейский население краков ицхак штерн данный фильм сыграть без лишний слово высоко всякий похвала пожалуй относиться актерский игра не наполнение картина стоить обращать внимание цветовой палитра фильм выдерживать откровенно черно белый тон не менее ряд персонаж подсвечивать яркий краска сторона не совсем понятно обусловливать персонаж выделять главный герой управлять сопереживать некого крайний мера персонаж не находить происходить ужасный фильм передавать допускать прекрасный художественный фильм решать вопрос передача дух художественный план список становиться ясно час просмотр понимать смотреть уставать приходиться наблюдать действо час фильм бункер наблюдать действие течение лента не задумываться хронометраж минута происходить качество вывод следующий не фильм топ судя заслуживать просмотр не фильм получать куча достойный не хватать сюжет динамика сопереживание не помнить случай нацист строить поместье концлагерь очень странный решение учитывать факт описывать уильям ширер указывать факт нацист стремиться привлекать коллаборант наиболее отмораживать нацист ликвидация еврейский цыганский советский народ странный решение держать собака намордник проводить еврейский конвой наоборот стоить давать возможность собака сделать дело достоверно касаться прочий особенность актер играть нацист внушать страх еврей фильм страх поглощать верить картинка очень классный операторский работа звук звуковой оформление очень высокий уровень концовка очень трогательный показывать советский солдат спускать повествование унитаз фильм очень сильно проседать мера повествование причина давать резюме очередной кино война автор не забывать сцена нагадить голова советский не становиться советовать просмотр
'''])

"""Обе модели Logistic Regression и MultinomialNB с обоими типами векторайзера оценили отрицательный отзыв как положительный.

**Вывод:**


1.   Результаты метрик оценки качества модели (логистическая регрессия) с разными векторайзерами высокие, практически одинаковые.
2.   Балансировка весов (векторайзер CountVectorizer) никак не сказалась на улучшении показателей метрик.

1.   Логистическая регрессия с векторайзером TF-IDF верно оценила отзыв (положительный) на сериал "Уэнсдэй", который модель MultinomialNB с TF-IDF отнесла к отрицательным.
2.   Обе модели Logistic Regression и MultinomialNB с обоими типами векторайзера оценили один и тот же отрицательный отзыв как положительный.

# ***Обучение на данных без препроцессинга***
"""

X0 = df['Text']
y0 = df['Class'].tolist()

X_train0, X_test0, y_train0, y_test0 = train_test_split(X0,
                                                        y0,
                                                        stratify= y0,
                                                        shuffle=True,
                                                        test_size=0.2,
                                                        random_state=42) # разделим выборку на тестовое и тренировочное множество

"""## ***Векторизация***

**CountVectorizer**
"""

count0 = CountVectorizer()

count0.fit(X_train0)

X_train_vec0 = count0.transform(X_train0)
X_test_vec0 =  count0.transform(X_test0)

"""**TF-IDF**"""

tf_idf0 = TfidfVectorizer()

tf_idf0.fit(X_train0)

X_train_tf0 = tf_idf0.transform(X_train0)
X_test_tf0 =  tf_idf0.transform(X_test0)

"""## ***LabelEncoder***"""

le0 = LabelEncoder()

le0.fit(y_train0)

le0.classes_

y_train_le0 = le0.transform(y_train0)
y_test_le0 = le0.transform(y_test0)

"""## ***Классификация***

## *MultinomialNB*

### **CountVectorizer**
"""

mnb0 = MultinomialNB()

mnb0.fit(X_train_vec0, y_train_le0)

y_test_pred_mnb0 = mnb0.predict(X_test_vec0)

print(classification_report(y_test_le0, y_test_pred_mnb0, target_names=le0.classes_))

cm_vec0 = confusion_matrix(y_test_le0, y_test_pred_mnb0)
cm_display_vec0 = ConfusionMatrixDisplay(cm_vec0, display_labels=le0.classes_).plot()

"""### **TF-IDF**"""

mnb_tf0 = MultinomialNB()

mnb_tf0.fit(X_train_tf0, y_train_le0)

y_test_pred_mnb_tf0 = mnb0.predict(X_test_tf0)

print(classification_report(y_test_le0, y_test_pred_mnb_tf0, target_names=le0.classes_))

cm_tf0 = confusion_matrix(y_test_le0, y_test_pred_mnb_tf0)
cm_display_tf0 = ConfusionMatrixDisplay(cm_tf0, display_labels=le0.classes_).plot()

"""### **Применение обученной модели на рандомных отзывах с сайта Кинопоиск**

**CountVectorizer**
"""

pipe_vec = Pipeline([('count0', CountVectorizer()),
                 ('mnb0', MultinomialNB())])

pipe_vec.fit(X0, y0)

# Фильм "Миссис Даутфайр" (отзыв положительный)
pipe_vec.predict(['''
Семейная 'немолодежная' комедия для субботнего вечера, с отлично проработанной сюжетной линией. Юмор в этой ленте несколько не типичен для Голливуда, но это не является недостатком, а даже наоборот.

Основной недостаток - это некоторая затянутость сюжета, особенно в первой половине фильма.'''])

# Сериал "Оленёнок" (отзыв отрицательный)
pipe_vec.predict(['''
Сталкинг дело крайне неприятное, и с определенной его формой, наверняка, сталкивались почти все.

Первая серия казалась действительно увлекательной пусть и странной. Но потом система Станиславского дала сбой. И единственная мысль, которая у меня осталась в конце сериала была 'не верю' ведь люди так не общаются и не ведут.

Герой типичный фрустрированный неудачник, который игнорирует все лучшее, что имеет, постоянно ища проблемы на свою задницу. Он ужасно шутит, совершенно не умеет общаться, ничего не понимает в отношениях, постоянно врет, и еще делает кучу всего отвратительного. Он не делает ничего для своего развития и роста. Зато одержим разными навязчивыми идеями, от стендапа до своей сталкерши.

Вся арка персонажа сводится к тому, что в финале он растрачивает все к чему шел на протяжении аж 7 серий. Понял ли где он был не прав? изменился ли он? Нет, но хотя бы разок сказал правду и пересказал весь сюжет в предпоследней серии.

Донни не раскрыт ни с одной сторон кроме темной(но то что он точно псих сомнений нет), не раскрыта и сталкерша, подруги героя, вообще никто, ну и вишенкой на торте вывод на базе 1 фразы.

В сухом остатке не очень понятно сколько в сериале тех самых 'реальных событий', но по ощущениям крайне мало. Цель сериала - самопиар и пожалейка по средствам очень сильно накрученной истории, фальшь тут лезет из всех щелей. Прямо таки Лжец Лжец из параллельной вселенной. Одна только концепция, что герой живет у мамы своей бывшей усложняет веру в происходящее.

Из плюсов: мрачная и угнетающая атмосфера, хорошая актерская игра, приятная картинка.

Из минусов: долго, пусто, не раскрытые герои, плохие диалоги, постоянный крупный план, растянутое повествование, много всего запрещенного и противоприродного. Вместо всего сериала можно просто посмотреть 6 серию.
'''])

# Фильм "Молодость (2015)" (отзыв отрицательный)
pipe_vec.predict(['''
Удивляюсь, отчего столько положительных отзывов? Это меня в итоге и вынудило посмотреть.

Главное достоинство фильма по мнению многих - это красивая природа Швейцарии и работа оператора, который умеет преподнести любой кадр. На деле - это даже не набор красивых клипов. Швейцария и вся ее природа умещается в рекламном трейлере. Нет никакой особой природы в фильме, увы. Пару коров, деревенский луг крупным планом, вид на горы и все. Такое ощущение, что снимали только то, что было вокруг отеля.

Также и с сюжетом - его нет. Что вижу, то пою. И это даже не поэзия прозы жизни и никакая не философия. Да, потуги на философию есть. Но связного сюжета нет. Все герои и их истории - это кусочки мозаики, которые в конце не будут целым.

Фильм, если это можно назвать фильмом - это вырванные наблюдения скучающего старика. Не интересные, сразу скажу. И мысли у старика тоже скучные.

Но главный минус - это стремление все опошлить, сделать фарсом. Страстно поющую певицу, пусть и не красавицу, надо показать после ее восхитительного выступления, как отвратительную бабу, жрущую, да простите за выражение, зажаренную курицу в белых перчатках. Спа отель в фильме - это сборище омерзительных мумий, которые говорят, как они писают и развратничают. Нет, это не реализм, а цинизм и бред.
'''])

"""**TF-IDF**"""

pipe_tf0 = Pipeline([('tf_idf0', TfidfVectorizer()),
                 ('mnb_tf0', MultinomialNB())])

pipe_tf0.fit(X0, y0)

# Фильм "Миссис Даутфайр" (отзыв положительный)
pipe_tf0.predict(['''
Семейная 'немолодежная' комедия для субботнего вечера, с отлично проработанной сюжетной линией. Юмор в этой ленте несколько не типичен для Голливуда, но это не является недостатком, а даже наоборот.

Основной недостаток - это некоторая затянутость сюжета, особенно в первой половине фильма.'''])

# Сериал "Оленёнок" (отзыв отрицательный)
pipe_tf0.predict(['''
Сталкинг дело крайне неприятное, и с определенной его формой, наверняка, сталкивались почти все.

Первая серия казалась действительно увлекательной пусть и странной. Но потом система Станиславского дала сбой. И единственная мысль, которая у меня осталась в конце сериала была 'не верю' ведь люди так не общаются и не ведут.

Герой типичный фрустрированный неудачник, который игнорирует все лучшее, что имеет, постоянно ища проблемы на свою задницу. Он ужасно шутит, совершенно не умеет общаться, ничего не понимает в отношениях, постоянно врет, и еще делает кучу всего отвратительного. Он не делает ничего для своего развития и роста. Зато одержим разными навязчивыми идеями, от стендапа до своей сталкерши.

Вся арка персонажа сводится к тому, что в финале он растрачивает все к чему шел на протяжении аж 7 серий. Понял ли где он был не прав? изменился ли он? Нет, но хотя бы разок сказал правду и пересказал весь сюжет в предпоследней серии.

Донни не раскрыт ни с одной сторон кроме темной(но то что он точно псих сомнений нет), не раскрыта и сталкерша, подруги героя, вообще никто, ну и вишенкой на торте вывод на базе 1 фразы.

В сухом остатке не очень понятно сколько в сериале тех самых 'реальных событий', но по ощущениям крайне мало. Цель сериала - самопиар и пожалейка по средствам очень сильно накрученной истории, фальшь тут лезет из всех щелей. Прямо таки Лжец Лжец из параллельной вселенной. Одна только концепция, что герой живет у мамы своей бывшей усложняет веру в происходящее.

Из плюсов: мрачная и угнетающая атмосфера, хорошая актерская игра, приятная картинка.

Из минусов: долго, пусто, не раскрытые герои, плохие диалоги, постоянный крупный план, растянутое повествование, много всего запрещенного и противоприродного. Вместо всего сериала можно просто посмотреть 6 серию.
'''])

# Фильм "Молодость (2015)" (отзыв отрицательный)
pipe_tf0.predict(['''
Удивляюсь, отчего столько положительных отзывов? Это меня в итоге и вынудило посмотреть.

Главное достоинство фильма по мнению многих - это красивая природа Швейцарии и работа оператора, который умеет преподнести любой кадр. На деле - это даже не набор красивых клипов. Швейцария и вся ее природа умещается в рекламном трейлере. Нет никакой особой природы в фильме, увы. Пару коров, деревенский луг крупным планом, вид на горы и все. Такое ощущение, что снимали только то, что было вокруг отеля.

Также и с сюжетом - его нет. Что вижу, то пою. И это даже не поэзия прозы жизни и никакая не философия. Да, потуги на философию есть. Но связного сюжета нет. Все герои и их истории - это кусочки мозаики, которые в конце не будут целым.

Фильм, если это можно назвать фильмом - это вырванные наблюдения скучающего старика. Не интересные, сразу скажу. И мысли у старика тоже скучные.

Но главный минус - это стремление все опошлить, сделать фарсом. Страстно поющую певицу, пусть и не красавицу, надо показать после ее восхитительного выступления, как отвратительную бабу, жрущую, да простите за выражение, зажаренную курицу в белых перчатках. Спа отель в фильме - это сборище омерзительных мумий, которые говорят, как они писают и развратничают. Нет, это не реализм, а цинизм и бред.'''])

"""## **Логистическая регрессия**

### **CountVectorizer**
"""

log_clf0 = LogisticRegression(random_state=0, max_iter=1000)

log_clf0.fit(X_train_vec0, y_train_le0)

y_pred_lg0 = log_clf0.predict(X_test_vec0)

print(classification_report(y_test_le0, y_pred_lg0, target_names = le0.classes_))

cm_lg_vec0 = confusion_matrix(y_test_le0, y_pred_lg0)
cm_display_lg = ConfusionMatrixDisplay(cm_lg_vec0, display_labels=le0.classes_).plot()

"""### **TF-IDF**"""

log_clf_tf0 = LogisticRegression(random_state=0, max_iter=1000)

log_clf_tf0.fit(X_train_tf0, y_train_le0)

y_pred_lg_tf0 = log_clf_tf0.predict(X_test_tf0)

print(classification_report(y_test_le0, y_pred_lg_tf0 , target_names = le0.classes_))

cm_lg_tf0 = confusion_matrix(y_test_le0, y_pred_lg_tf0)
cm_display_lg_tf0 = ConfusionMatrixDisplay(cm_lg_tf0, display_labels=le0.classes_).plot()

"""### **Применение обученной модели на рандомных отзывах с сайта Кинопоиск**

**CountVectorizer**
"""

pipe_lg_vec0 = Pipeline([('count0', CountVectorizer()),
                 ('log_clf0', LogisticRegression(max_iter=1000))])

pipe_lg_vec0.fit(X0, y0)

# Фильм "Ночной дозор" (отзыв положительный)
pipe_lg_vec0.predict(['''

Классический, как может показаться сначала, конфликт добра со злом содержит в себе несколько драматургических сюрпризов, которые раскрываются перед нами по мере повествования.

Тут и проблематика смены эпохи после распада Советского союза, когда 'старое' пытается удержаться под давлением 'нового' и отстоять свою парадигму.

Тут же и тема инициации ребёнка, который в свои 12 лет встаёт перед выбором 'лагеря' для дальнейшего взросления.

Если копнуть поглубже, то окажется, что все герои изначально - пешки на доске Завулона, который заранее уже всё просчитал, хотя по ходу сюжета он может показаться достаточно пассивным персонажем, который будто бы нехотя периодически вмешивается в события фильма. Отчасти мы видим это в эпизодах его игры в Мортал комбат.

Конечно если говорить о жанре, то здесь как раз-таки возникнет 'коктейль' из драмы, боевика, ужасов и возможно чего-то ещё. Но если учесть новизну такого кино для России начала 2000-х, то это можно записать скорее в плюсы. Бекмамбетов попробовал использовать всё и даёт возможность 'вкусить' это и зрителю.

Всё это приправлено клиповым монтажом, который стал для зрителей 2004 года новинкой и придал фильму ту самую 'блокбастерность', которую так хотели тем же зрителям и продать.
'''])

# Сериал "Одни из нас" (отзыв отрицательный)
pipe_lg_vec0.predict(['''
Как истинный фанат игры The Last of Us я решила посмотреть этот сериал и на 3 серии просто БЫЛА ПОРАЖЕНА.

Могу сказать, что вся атмосфера и серии в принципе сделаны по каждой части игры. Как идет игра по сюжету так она и развивается в сериале. Графика замечательно сделана, как в игре, все щелкуны и зомби попадание 'в точку'. Звуки тоже совпадают.

Я могу смириться с тем, что актеры не похожи на персонажей из игры. Как Сара, которая в игре белокурая, фарфоровая нежная девочка, то в сериале она более грубее выглядит и она афроамериканка (не в обиду афроамериканцам, я их уважаю, к актрисе нет никаких претензий). Джоэл и Томми отлично подобранные актеры, мимика, манера поведения, все 'в точку'.

Билл... Билл стал геем в 3 серии. Для меня это удар и поражение в сердце острым ножом... ЗАЧЕМ? Билл для меня в игре был настоящим кумиром и гением, который придумал ловушки, обустроил свое убежище и хорошо адаптировался в условиях апокалипсиса.

Что я вижу в сериале. Билл такой же гений, только более мягкий и покладистее. Билл стал подстилкой, который занимается любовью с мужчиной...

Я надеюсь, что когда-нибудь мы сможем увидеть реально отличный сериал по мотивам этой легендарной игры.

Дальше 3 серии я смотреть не стану, для меня это шок.'''])

"""**Ошибочные предсказания**"""

# Фильм "Дьявол носит Prada" (отзыв отрицательный)
pipe_lg_vec0.predict(['''

Еще в детстве, когда я смотрела этот фильм, мне очень понравилась картинка, очень понравились главные героини. Но мне не понравился посыл: стань такой, какой хочет твой мужик и токсичные друзья. Я тогда ещё не знала слово «токсичный», но я остро ощутила, что так жить нельзя. Что с горных вершин она падает в болото, в котором она не сможет быть собой. Миранда реально тянула героиню вверх. А старые друзья были как крабы в банке, которые хотели лишь одного — чтобы она оставалась такой, какой была раньше.

Миранда заставила измениться героиню внешне. Но внутренне девушка осталось той же яркой, целеустремлённой натурой, которой была. Более того, она ещё сильнее открыла в себе эти качества. Миранда не лезла к ней в душу, не заставляла изменить свой характер. Она хотела только одного — качественного выполнения работы. И девушка, выполняя ее, значительно выросла личностно, стала организованной и хваткой, а не безответственной и расхлябанной, как раньше, что замечает и её начальница. Обратно же героиня падает потому, что сценаристы хотели показать: главное — отношение. Как человека, бывший в токсичном окружении много лет, могу сказать: не любые отношения стоят того.

У героини были все шансы построить новые отношения с людьми, подобными ей. Но она испугалась одиночества, разочарования, в которое на время впала Миранда. Ей кажется, что слова, сказанные в горькую минуту, и есть её настоящая жизнь. Она испугалась, что ее ждет такая же жалкая жизнь. На самом деле жизнь Миранды далеко не жалкая. Она в полной мере реализует свой талант. Она может позволить себе быть искренней даже с помощницей и не бояться осуждения. Да, она не пускает незнакомых людей в душу, но в этом и суть! Энди сама точно охарактеризовала ее: «Будь Миранда мужчиной, все бы только и говорили о том, что она мастер своего дела». А ещё у Миранды двое любимых и любящих её дочерей.

Энди не дала себе времени понять, что мир бизнеса не для розовых соплей и сантиментов. Она не дала себе времени узнать новых людей, которые ее окружают, понять, что ими движет. Она поспешила их осудить по меркам домашних посиделок и милых междусобойчиков. Как овечка, привыкнув жить в овечьем стаде, начинает считать прайд львов каким-то жестоким и кровожадным. И будет права по меркам овечьего стада. Но не по меркам хищников. А еще Энди не понимает одну простую вещь: она сама не овечка. Она хищница. И она успешно демонстрирует это на протяжении всего фильма. Вернувшись в овечье стадо, она обращает свою собственную силу против себя. И ей ещё предстоит это узнать.

И конечно, Миранда никакой не дьявол. Она обычный человек, который любит свою семью, хочет самореализации, тщательно выбирает свой ближний круг и помогает своей бывшей помощнице найти новую работу. Как мать, которая прощает непутевого ребенка. И если это дьяволизм, то нам всем не мешало бы поучиться такому дьяволизму.

Мораль ужасна и перечеркивает всё, но фильм как произведение искусства
'''])

# Фильм "Человек швейцарский нож" (отзыв отрицательный)
pipe_lg_vec0.predict(['''
Поверьте, я терпимо отношусь к секс-меньшинствам. И признаю вклад их представителей в сферы различных искусств. Прочтя несколько рецензий к этому фильму, сели с семьей (я, жена (нам около 40), и дочь 12 лет) провести вечер с интересным фильмом. Дочь так вообще обожает Гарри Поттера, и ждала Рэдклиффа увидеть в непривычной для него роли. Но...

Господа, у фильма во второй его половине мы с женой явно разглядели его месседж. Главный герой не ищет себя, как тут кто-то в рецензиях написал. ГГ просто скрывает свою ориентацию; под надуманными предлогами отказывается от общения с девушками, своим отцом, прячется от людей, и оттягивает момент возвращения из своего 'побега'. Моральные переживания и излияния-монологи я не буду подробно передавать - это поток слов, оправдывающих его 'некаквсейность'. Но создатели фильма таки нашли способ отнестись к (себе?) геям с юмором: множество приколов основано на анатомических особенностях практикующих нетрадиционный секс мужчин (я про задний проход). Это и создает у неискушенных зрителей ложное ощущение комедийности фильма. Получается, фильмец с двойным дном: разбавив сюжет моральными переживаниями ГГ, нам пропагандируют отношения мужчина-мужчина во всех его многогранностях. Человек-швейцарский нож - это гей на необитаемом острове.

Дочка, слава Богу, не все поняла, и просто посмеялась над некоторыми моментами.
'''])

# Фильм "Однажды в Америке" (отзыв отрицательный)
pipe_lg_vec0.predict(['''
Начинать критику нужно с фундамента, поэтому вначале прогуляемся по книге 'банды', именно эта макулатура послужила для экранизации, автор этого сборника сказок Гарри Грэй - диванный мафиози. Вся книга это склейка наворованных сюжетов из гангстерского кино 30-ых, которые автор выдает за свою прожитую жизнь, в частности плагиат из фильмов с участием Джеймса Кэгни, например Ангелы с грязными лицами (1938), этот фильм как-то пародировали в Один дома (1990), тот самый которым Кевин Маккалистер спугнул грабителя и доставщика пиццы, а так-же: Враг общества (1931), Ревущие двадцатые, или Судьба солдата в Америке (1939) и Белая горячка (1949).

Мамкин хулиган по имени Гарри Грэй любит ни только Джеймса Кэгни, так-же он предпочитает режиссера Уильяма Уайлера и его фильм Тупик (1937), там и знакомства с Максом и тема с часами и многое другие, автор книги все это так-же выдал за свою историю жизни. Книга The Hoods, вышла в 1952, но все фильмы откуда украли сюжет, вышли в эпоху 30-ых годов, в самый расцвет гангстерского кино. Реальная история такова, Гарри Грэй опасными вечерами сидел в безопасном кинотеатре и смотрел гангстерское кино, затем приходил домой к любимой мамочки и шел в свою комнату - чтобы сесть за печатную машинку и напечатать все те сцены что ему понравились на большом экране кинотеатре, разумеется выдавая все это за свой жизненный путь.

Цветокоррекция у Однажды в Америке, такая-же как и в Крестном отце, стиль подачи, операторская работа и даже режиссура, все мастерство Серджо Леоне одолжил у Фрэнсис Форд Коппола. Получается мамкин гангстер Гарри Грэй одолжил сюжет у Голливуда 30-ых годов, а Леоне все остальное у Копполы, соответственно у Однажды в Америке нету ничего своего, кроме Эннио Морриконе, величайшего маэстро.

Актерский состав, из всех гангстерских фильмов, именно в этом фильме актеры играют ни совсем так хорошо, как в остальных гангстерских фильмах.

Хронометраж слишком долгий, хотя я как раз любитель тех фильмов что длятся больше трех часов, но именно эта кинолента заслуживает лишь старых, добрых сто минут.
'''])

# Посмотрим, как справится MultinomialNB + CountVectorizer

# Фильм "Дьявол носит Prada" (отзыв отрицательный)
pipe_vec.predict(['''

Еще в детстве, когда я смотрела этот фильм, мне очень понравилась картинка, очень понравились главные героини. Но мне не понравился посыл: стань такой, какой хочет твой мужик и токсичные друзья. Я тогда ещё не знала слово «токсичный», но я остро ощутила, что так жить нельзя. Что с горных вершин она падает в болото, в котором она не сможет быть собой. Миранда реально тянула героиню вверх. А старые друзья были как крабы в банке, которые хотели лишь одного — чтобы она оставалась такой, какой была раньше.

Миранда заставила измениться героиню внешне. Но внутренне девушка осталось той же яркой, целеустремлённой натурой, которой была. Более того, она ещё сильнее открыла в себе эти качества. Миранда не лезла к ней в душу, не заставляла изменить свой характер. Она хотела только одного — качественного выполнения работы. И девушка, выполняя ее, значительно выросла личностно, стала организованной и хваткой, а не безответственной и расхлябанной, как раньше, что замечает и её начальница. Обратно же героиня падает потому, что сценаристы хотели показать: главное — отношение. Как человека, бывший в токсичном окружении много лет, могу сказать: не любые отношения стоят того.

У героини были все шансы построить новые отношения с людьми, подобными ей. Но она испугалась одиночества, разочарования, в которое на время впала Миранда. Ей кажется, что слова, сказанные в горькую минуту, и есть её настоящая жизнь. Она испугалась, что ее ждет такая же жалкая жизнь. На самом деле жизнь Миранды далеко не жалкая. Она в полной мере реализует свой талант. Она может позволить себе быть искренней даже с помощницей и не бояться осуждения. Да, она не пускает незнакомых людей в душу, но в этом и суть! Энди сама точно охарактеризовала ее: «Будь Миранда мужчиной, все бы только и говорили о том, что она мастер своего дела». А ещё у Миранды двое любимых и любящих её дочерей.

Энди не дала себе времени понять, что мир бизнеса не для розовых соплей и сантиментов. Она не дала себе времени узнать новых людей, которые ее окружают, понять, что ими движет. Она поспешила их осудить по меркам домашних посиделок и милых междусобойчиков. Как овечка, привыкнув жить в овечьем стаде, начинает считать прайд львов каким-то жестоким и кровожадным. И будет права по меркам овечьего стада. Но не по меркам хищников. А еще Энди не понимает одну простую вещь: она сама не овечка. Она хищница. И она успешно демонстрирует это на протяжении всего фильма. Вернувшись в овечье стадо, она обращает свою собственную силу против себя. И ей ещё предстоит это узнать.

И конечно, Миранда никакой не дьявол. Она обычный человек, который любит свою семью, хочет самореализации, тщательно выбирает свой ближний круг и помогает своей бывшей помощнице найти новую работу. Как мать, которая прощает непутевого ребенка. И если это дьяволизм, то нам всем не мешало бы поучиться такому дьяволизму.

Мораль ужасна и перечеркивает всё, но фильм как произведение искусства
'''])

# Фильм "Человек швейцарский нож" (отзыв отрицательный)
pipe_vec.predict(['''
Поверьте, я терпимо отношусь к секс-меньшинствам. И признаю вклад их представителей в сферы различных искусств. Прочтя несколько рецензий к этому фильму, сели с семьей (я, жена (нам около 40), и дочь 12 лет) провести вечер с интересным фильмом. Дочь так вообще обожает Гарри Поттера, и ждала Рэдклиффа увидеть в непривычной для него роли. Но...

Господа, у фильма во второй его половине мы с женой явно разглядели его месседж. Главный герой не ищет себя, как тут кто-то в рецензиях написал. ГГ просто скрывает свою ориентацию; под надуманными предлогами отказывается от общения с девушками, своим отцом, прячется от людей, и оттягивает момент возвращения из своего 'побега'. Моральные переживания и излияния-монологи я не буду подробно передавать - это поток слов, оправдывающих его 'некаквсейность'. Но создатели фильма таки нашли способ отнестись к (себе?) геям с юмором: множество приколов основано на анатомических особенностях практикующих нетрадиционный секс мужчин (я про задний проход). Это и создает у неискушенных зрителей ложное ощущение комедийности фильма. Получается, фильмец с двойным дном: разбавив сюжет моральными переживаниями ГГ, нам пропагандируют отношения мужчина-мужчина во всех его многогранностях. Человек-швейцарский нож - это гей на необитаемом острове.

Дочка, слава Богу, не все поняла, и просто посмеялась над некоторыми моментами.
'''])

# Фильм "Однажды в Америке" (отзыв отрицательный)
pipe_vec.predict(['''
Начинать критику нужно с фундамента, поэтому вначале прогуляемся по книге 'банды', именно эта макулатура послужила для экранизации, автор этого сборника сказок Гарри Грэй - диванный мафиози. Вся книга это склейка наворованных сюжетов из гангстерского кино 30-ых, которые автор выдает за свою прожитую жизнь, в частности плагиат из фильмов с участием Джеймса Кэгни, например Ангелы с грязными лицами (1938), этот фильм как-то пародировали в Один дома (1990), тот самый которым Кевин Маккалистер спугнул грабителя и доставщика пиццы, а так-же: Враг общества (1931), Ревущие двадцатые, или Судьба солдата в Америке (1939) и Белая горячка (1949).

Мамкин хулиган по имени Гарри Грэй любит ни только Джеймса Кэгни, так-же он предпочитает режиссера Уильяма Уайлера и его фильм Тупик (1937), там и знакомства с Максом и тема с часами и многое другие, автор книги все это так-же выдал за свою историю жизни. Книга The Hoods, вышла в 1952, но все фильмы откуда украли сюжет, вышли в эпоху 30-ых годов, в самый расцвет гангстерского кино. Реальная история такова, Гарри Грэй опасными вечерами сидел в безопасном кинотеатре и смотрел гангстерское кино, затем приходил домой к любимой мамочки и шел в свою комнату - чтобы сесть за печатную машинку и напечатать все те сцены что ему понравились на большом экране кинотеатре, разумеется выдавая все это за свой жизненный путь.

Цветокоррекция у Однажды в Америке, такая-же как и в Крестном отце, стиль подачи, операторская работа и даже режиссура, все мастерство Серджо Леоне одолжил у Фрэнсис Форд Коппола. Получается мамкин гангстер Гарри Грэй одолжил сюжет у Голливуда 30-ых годов, а Леоне все остальное у Копполы, соответственно у Однажды в Америке нету ничего своего, кроме Эннио Морриконе, величайшего маэстро.

Актерский состав, из всех гангстерских фильмов, именно в этом фильме актеры играют ни совсем так хорошо, как в остальных гангстерских фильмах.

Хронометраж слишком долгий, хотя я как раз любитель тех фильмов что длятся больше трех часов, но именно эта кинолента заслуживает лишь старых, добрых сто минут.
'''])

"""**TF-IDF**"""

pipe_lg_tf0 = Pipeline([('tf_idf0', TfidfVectorizer()),
                 ('log_clf_tf0', LogisticRegression(max_iter=1000))])

pipe_lg_tf0.fit(X0, y0)

# Фильм "Ночной дозор" (отзыв положительный)
pipe_lg_tf0.predict(['''

Классический, как может показаться сначала, конфликт добра со злом содержит в себе несколько драматургических сюрпризов, которые раскрываются перед нами по мере повествования.

Тут и проблематика смены эпохи после распада Советского союза, когда 'старое' пытается удержаться под давлением 'нового' и отстоять свою парадигму.

Тут же и тема инициации ребёнка, который в свои 12 лет встаёт перед выбором 'лагеря' для дальнейшего взросления.

Если копнуть поглубже, то окажется, что все герои изначально - пешки на доске Завулона, который заранее уже всё просчитал, хотя по ходу сюжета он может показаться достаточно пассивным персонажем, который будто бы нехотя периодически вмешивается в события фильма. Отчасти мы видим это в эпизодах его игры в Мортал комбат.

Конечно если говорить о жанре, то здесь как раз-таки возникнет 'коктейль' из драмы, боевика, ужасов и возможно чего-то ещё. Но если учесть новизну такого кино для России начала 2000-х, то это можно записать скорее в плюсы. Бекмамбетов попробовал использовать всё и даёт возможность 'вкусить' это и зрителю.

Всё это приправлено клиповым монтажом, который стал для зрителей 2004 года новинкой и придал фильму ту самую 'блокбастерность', которую так хотели тем же зрителям и продать.
'''])

# Сериал "Одни из нас" (отзыв отрицательный)
pipe_lg_tf0.predict(['''
Как истинный фанат игры The Last of Us я решила посмотреть этот сериал и на 3 серии просто БЫЛА ПОРАЖЕНА.

Могу сказать, что вся атмосфера и серии в принципе сделаны по каждой части игры. Как идет игра по сюжету так она и развивается в сериале. Графика замечательно сделана, как в игре, все щелкуны и зомби попадание 'в точку'. Звуки тоже совпадают.

Я могу смириться с тем, что актеры не похожи на персонажей из игры. Как Сара, которая в игре белокурая, фарфоровая нежная девочка, то в сериале она более грубее выглядит и она афроамериканка (не в обиду афроамериканцам, я их уважаю, к актрисе нет никаких претензий). Джоэл и Томми отлично подобранные актеры, мимика, манера поведения, все 'в точку'.

Билл... Билл стал геем в 3 серии. Для меня это удар и поражение в сердце острым ножом... ЗАЧЕМ? Билл для меня в игре был настоящим кумиром и гением, который придумал ловушки, обустроил свое убежище и хорошо адаптировался в условиях апокалипсиса.

Что я вижу в сериале. Билл такой же гений, только более мягкий и покладистее. Билл стал подстилкой, который занимается любовью с мужчиной...

Я надеюсь, что когда-нибудь мы сможем увидеть реально отличный сериал по мотивам этой легендарной игры.

Дальше 3 серии я смотреть не стану, для меня это шок.'''])

"""**Ошибочные предсказания**"""

# Фильм "Дьявол носит Prada" (отзыв отрицательный)
pipe_lg_tf0.predict(['''

Еще в детстве, когда я смотрела этот фильм, мне очень понравилась картинка, очень понравились главные героини. Но мне не понравился посыл: стань такой, какой хочет твой мужик и токсичные друзья. Я тогда ещё не знала слово «токсичный», но я остро ощутила, что так жить нельзя. Что с горных вершин она падает в болото, в котором она не сможет быть собой. Миранда реально тянула героиню вверх. А старые друзья были как крабы в банке, которые хотели лишь одного — чтобы она оставалась такой, какой была раньше.

Миранда заставила измениться героиню внешне. Но внутренне девушка осталось той же яркой, целеустремлённой натурой, которой была. Более того, она ещё сильнее открыла в себе эти качества. Миранда не лезла к ней в душу, не заставляла изменить свой характер. Она хотела только одного — качественного выполнения работы. И девушка, выполняя ее, значительно выросла личностно, стала организованной и хваткой, а не безответственной и расхлябанной, как раньше, что замечает и её начальница. Обратно же героиня падает потому, что сценаристы хотели показать: главное — отношение. Как человека, бывший в токсичном окружении много лет, могу сказать: не любые отношения стоят того.

У героини были все шансы построить новые отношения с людьми, подобными ей. Но она испугалась одиночества, разочарования, в которое на время впала Миранда. Ей кажется, что слова, сказанные в горькую минуту, и есть её настоящая жизнь. Она испугалась, что ее ждет такая же жалкая жизнь. На самом деле жизнь Миранды далеко не жалкая. Она в полной мере реализует свой талант. Она может позволить себе быть искренней даже с помощницей и не бояться осуждения. Да, она не пускает незнакомых людей в душу, но в этом и суть! Энди сама точно охарактеризовала ее: «Будь Миранда мужчиной, все бы только и говорили о том, что она мастер своего дела». А ещё у Миранды двое любимых и любящих её дочерей.

Энди не дала себе времени понять, что мир бизнеса не для розовых соплей и сантиментов. Она не дала себе времени узнать новых людей, которые ее окружают, понять, что ими движет. Она поспешила их осудить по меркам домашних посиделок и милых междусобойчиков. Как овечка, привыкнув жить в овечьем стаде, начинает считать прайд львов каким-то жестоким и кровожадным. И будет права по меркам овечьего стада. Но не по меркам хищников. А еще Энди не понимает одну простую вещь: она сама не овечка. Она хищница. И она успешно демонстрирует это на протяжении всего фильма. Вернувшись в овечье стадо, она обращает свою собственную силу против себя. И ей ещё предстоит это узнать.

И конечно, Миранда никакой не дьявол. Она обычный человек, который любит свою семью, хочет самореализации, тщательно выбирает свой ближний круг и помогает своей бывшей помощнице найти новую работу. Как мать, которая прощает непутевого ребенка. И если это дьяволизм, то нам всем не мешало бы поучиться такому дьяволизму.

Мораль ужасна и перечеркивает всё, но фильм как произведение искусства
'''])

# Фильм "Человек швейцарский нож" (отзыв отрицательный)
pipe_lg_tf0.predict(['''
Поверьте, я терпимо отношусь к секс-меньшинствам. И признаю вклад их представителей в сферы различных искусств. Прочтя несколько рецензий к этому фильму, сели с семьей (я, жена (нам около 40), и дочь 12 лет) провести вечер с интересным фильмом. Дочь так вообще обожает Гарри Поттера, и ждала Рэдклиффа увидеть в непривычной для него роли. Но...

Господа, у фильма во второй его половине мы с женой явно разглядели его месседж. Главный герой не ищет себя, как тут кто-то в рецензиях написал. ГГ просто скрывает свою ориентацию; под надуманными предлогами отказывается от общения с девушками, своим отцом, прячется от людей, и оттягивает момент возвращения из своего 'побега'. Моральные переживания и излияния-монологи я не буду подробно передавать - это поток слов, оправдывающих его 'некаквсейность'. Но создатели фильма таки нашли способ отнестись к (себе?) геям с юмором: множество приколов основано на анатомических особенностях практикующих нетрадиционный секс мужчин (я про задний проход). Это и создает у неискушенных зрителей ложное ощущение комедийности фильма. Получается, фильмец с двойным дном: разбавив сюжет моральными переживаниями ГГ, нам пропагандируют отношения мужчина-мужчина во всех его многогранностях. Человек-швейцарский нож - это гей на необитаемом острове.

Дочка, слава Богу, не все поняла, и просто посмеялась над некоторыми моментами.
'''])

# Фильм "Однажды в Америке" (отзыв отрицательный)
pipe_lg_tf0.predict(['''
Начинать критику нужно с фундамента, поэтому вначале прогуляемся по книге 'банды', именно эта макулатура послужила для экранизации, автор этого сборника сказок Гарри Грэй - диванный мафиози. Вся книга это склейка наворованных сюжетов из гангстерского кино 30-ых, которые автор выдает за свою прожитую жизнь, в частности плагиат из фильмов с участием Джеймса Кэгни, например Ангелы с грязными лицами (1938), этот фильм как-то пародировали в Один дома (1990), тот самый которым Кевин Маккалистер спугнул грабителя и доставщика пиццы, а так-же: Враг общества (1931), Ревущие двадцатые, или Судьба солдата в Америке (1939) и Белая горячка (1949).

Мамкин хулиган по имени Гарри Грэй любит ни только Джеймса Кэгни, так-же он предпочитает режиссера Уильяма Уайлера и его фильм Тупик (1937), там и знакомства с Максом и тема с часами и многое другие, автор книги все это так-же выдал за свою историю жизни. Книга The Hoods, вышла в 1952, но все фильмы откуда украли сюжет, вышли в эпоху 30-ых годов, в самый расцвет гангстерского кино. Реальная история такова, Гарри Грэй опасными вечерами сидел в безопасном кинотеатре и смотрел гангстерское кино, затем приходил домой к любимой мамочки и шел в свою комнату - чтобы сесть за печатную машинку и напечатать все те сцены что ему понравились на большом экране кинотеатре, разумеется выдавая все это за свой жизненный путь.

Цветокоррекция у Однажды в Америке, такая-же как и в Крестном отце, стиль подачи, операторская работа и даже режиссура, все мастерство Серджо Леоне одолжил у Фрэнсис Форд Коппола. Получается мамкин гангстер Гарри Грэй одолжил сюжет у Голливуда 30-ых годов, а Леоне все остальное у Копполы, соответственно у Однажды в Америке нету ничего своего, кроме Эннио Морриконе, величайшего маэстро.

Актерский состав, из всех гангстерских фильмов, именно в этом фильме актеры играют ни совсем так хорошо, как в остальных гангстерских фильмах.

Хронометраж слишком долгий, хотя я как раз любитель тех фильмов что длятся больше трех часов, но именно эта кинолента заслуживает лишь старых, добрых сто минут.
'''])

# Посмотрим, как справится MultinomialNB + TF-IDF

pipe_tf0.predict(['''

Еще в детстве, когда я смотрела этот фильм, мне очень понравилась картинка, очень понравились главные героини. Но мне не понравился посыл: стань такой, какой хочет твой мужик и токсичные друзья. Я тогда ещё не знала слово «токсичный», но я остро ощутила, что так жить нельзя. Что с горных вершин она падает в болото, в котором она не сможет быть собой. Миранда реально тянула героиню вверх. А старые друзья были как крабы в банке, которые хотели лишь одного — чтобы она оставалась такой, какой была раньше.

Миранда заставила измениться героиню внешне. Но внутренне девушка осталось той же яркой, целеустремлённой натурой, которой была. Более того, она ещё сильнее открыла в себе эти качества. Миранда не лезла к ней в душу, не заставляла изменить свой характер. Она хотела только одного — качественного выполнения работы. И девушка, выполняя ее, значительно выросла личностно, стала организованной и хваткой, а не безответственной и расхлябанной, как раньше, что замечает и её начальница. Обратно же героиня падает потому, что сценаристы хотели показать: главное — отношение. Как человека, бывший в токсичном окружении много лет, могу сказать: не любые отношения стоят того.

У героини были все шансы построить новые отношения с людьми, подобными ей. Но она испугалась одиночества, разочарования, в которое на время впала Миранда. Ей кажется, что слова, сказанные в горькую минуту, и есть её настоящая жизнь. Она испугалась, что ее ждет такая же жалкая жизнь. На самом деле жизнь Миранды далеко не жалкая. Она в полной мере реализует свой талант. Она может позволить себе быть искренней даже с помощницей и не бояться осуждения. Да, она не пускает незнакомых людей в душу, но в этом и суть! Энди сама точно охарактеризовала ее: «Будь Миранда мужчиной, все бы только и говорили о том, что она мастер своего дела». А ещё у Миранды двое любимых и любящих её дочерей.

Энди не дала себе времени понять, что мир бизнеса не для розовых соплей и сантиментов. Она не дала себе времени узнать новых людей, которые ее окружают, понять, что ими движет. Она поспешила их осудить по меркам домашних посиделок и милых междусобойчиков. Как овечка, привыкнув жить в овечьем стаде, начинает считать прайд львов каким-то жестоким и кровожадным. И будет права по меркам овечьего стада. Но не по меркам хищников. А еще Энди не понимает одну простую вещь: она сама не овечка. Она хищница. И она успешно демонстрирует это на протяжении всего фильма. Вернувшись в овечье стадо, она обращает свою собственную силу против себя. И ей ещё предстоит это узнать.

И конечно, Миранда никакой не дьявол. Она обычный человек, который любит свою семью, хочет самореализации, тщательно выбирает свой ближний круг и помогает своей бывшей помощнице найти новую работу. Как мать, которая прощает непутевого ребенка. И если это дьяволизм, то нам всем не мешало бы поучиться такому дьяволизму.

Мораль ужасна и перечеркивает всё, но фильм как произведение искусства
'''])

# Фильм "Человек швейцарский нож" (отзыв отрицательный)
pipe_tf0.predict(['''
Поверьте, я терпимо отношусь к секс-меньшинствам. И признаю вклад их представителей в сферы различных искусств. Прочтя несколько рецензий к этому фильму, сели с семьей (я, жена (нам около 40), и дочь 12 лет) провести вечер с интересным фильмом. Дочь так вообще обожает Гарри Поттера, и ждала Рэдклиффа увидеть в непривычной для него роли. Но...

Господа, у фильма во второй его половине мы с женой явно разглядели его месседж. Главный герой не ищет себя, как тут кто-то в рецензиях написал. ГГ просто скрывает свою ориентацию; под надуманными предлогами отказывается от общения с девушками, своим отцом, прячется от людей, и оттягивает момент возвращения из своего 'побега'. Моральные переживания и излияния-монологи я не буду подробно передавать - это поток слов, оправдывающих его 'некаквсейность'. Но создатели фильма таки нашли способ отнестись к (себе?) геям с юмором: множество приколов основано на анатомических особенностях практикующих нетрадиционный секс мужчин (я про задний проход). Это и создает у неискушенных зрителей ложное ощущение комедийности фильма. Получается, фильмец с двойным дном: разбавив сюжет моральными переживаниями ГГ, нам пропагандируют отношения мужчина-мужчина во всех его многогранностях. Человек-швейцарский нож - это гей на необитаемом острове.

Дочка, слава Богу, не все поняла, и просто посмеялась над некоторыми моментами.
'''])

# Фильм "Однажды в Америке" (отзыв отрицательный)
pipe_tf0.predict(['''
Начинать критику нужно с фундамента, поэтому вначале прогуляемся по книге 'банды', именно эта макулатура послужила для экранизации, автор этого сборника сказок Гарри Грэй - диванный мафиози. Вся книга это склейка наворованных сюжетов из гангстерского кино 30-ых, которые автор выдает за свою прожитую жизнь, в частности плагиат из фильмов с участием Джеймса Кэгни, например Ангелы с грязными лицами (1938), этот фильм как-то пародировали в Один дома (1990), тот самый которым Кевин Маккалистер спугнул грабителя и доставщика пиццы, а так-же: Враг общества (1931), Ревущие двадцатые, или Судьба солдата в Америке (1939) и Белая горячка (1949).

Мамкин хулиган по имени Гарри Грэй любит ни только Джеймса Кэгни, так-же он предпочитает режиссера Уильяма Уайлера и его фильм Тупик (1937), там и знакомства с Максом и тема с часами и многое другие, автор книги все это так-же выдал за свою историю жизни. Книга The Hoods, вышла в 1952, но все фильмы откуда украли сюжет, вышли в эпоху 30-ых годов, в самый расцвет гангстерского кино. Реальная история такова, Гарри Грэй опасными вечерами сидел в безопасном кинотеатре и смотрел гангстерское кино, затем приходил домой к любимой мамочки и шел в свою комнату - чтобы сесть за печатную машинку и напечатать все те сцены что ему понравились на большом экране кинотеатре, разумеется выдавая все это за свой жизненный путь.

Цветокоррекция у Однажды в Америке, такая-же как и в Крестном отце, стиль подачи, операторская работа и даже режиссура, все мастерство Серджо Леоне одолжил у Фрэнсис Форд Коппола. Получается мамкин гангстер Гарри Грэй одолжил сюжет у Голливуда 30-ых годов, а Леоне все остальное у Копполы, соответственно у Однажды в Америке нету ничего своего, кроме Эннио Морриконе, величайшего маэстро.

Актерский состав, из всех гангстерских фильмов, именно в этом фильме актеры играют ни совсем так хорошо, как в остальных гангстерских фильмах.

Хронометраж слишком долгий, хотя я как раз любитель тех фильмов что длятся больше трех часов, но именно эта кинолента заслуживает лишь старых, добрых сто минут.
'''])

# ПРОВЕРИТЬ GRIDSEARCH

"""**Вывод:**


1.   Метрики оценки качества моделей MultinomialNB и LogisticRegression, обученных на данных без препроцессинга ниже, чем у моделей обученных на предобработанных данных. Также предсказательная способность ниже.
2.   Показательный пример с тремя отрицательными отзывами:

*   Логистическая регрессия с двумя типами векторайзеров полностью ошиблась — определила отрицательные отзывы, как положительные;
*   MultinomialNB + CountVectorizer верно определил только один из трех отзывов;

*   MultinomialNB (TF-IDF) справился лучше всех, верно определив тональность всех трех отрицательных отзывов.

# **Ансамблевая модель (RandomForestClassifier)**
"""

from sklearn.ensemble import RandomForestClassifier

"""**CountVectorizer**"""

rf_clf = RandomForestClassifier(random_state=0)

rf_clf.fit(X_train_vec, y_train_le)

rf_clf_preds = rf_clf.predict(X_test_vec)

print(classification_report(y_test_le, rf_clf_preds))

cm_rf_vec = confusion_matrix(y_test_le, rf_clf_preds)
cm_display_rf_vec = ConfusionMatrixDisplay(cm_rf_vec, display_labels=le.classes_).plot()

"""**TF-IDF**"""

rf_clf_tf = RandomForestClassifier(random_state=0)

rf_clf_tf.fit(X_train_tf_idf, y_train_le)

rf_clf_preds_tf = rf_clf_tf.predict(X_test_tf_idf)

print(classification_report(y_test_le, rf_clf_preds_tf))

cm_rf_tf = confusion_matrix(y_test_le, rf_clf_preds_tf)
cm_display_rf_tf = ConfusionMatrixDisplay(cm_rf_tf, display_labels=le.classes_).plot()

"""## **GridSearch в Random Forest**"""

from sklearn.model_selection import GridSearchCV

"""**CountVectorizer**"""

gs_params = {'max_depth': [2, 5, 10, None],
             'max_features': [0.3, 'sqrt', 1.0],
             'n_estimators': [10, 100, 500]}

gs = GridSearchCV(RandomForestClassifier(), gs_params, scoring='f1_weighted', verbose=5)

gs.fit(X_train_vec, y_train_le)

gs.best_params_

gs_preds = gs.predict(X_test_vec)

print(classification_report(y_test_le, gs_preds))

cm_rf_gs = confusion_matrix(y_test_le, gs_preds)
cm_display_gs = ConfusionMatrixDisplay(cm_rf_gs, display_labels=le.classes_).plot()

"""## **Применение обученной модели на рандомных отзывах с сайта Кинопоиск**"""

pipe_rf_clf = Pipeline([('count', CountVectorizer()),
                 ('rf_clf', RandomForestClassifier(max_depth = None, max_features = 'sqrt', n_estimators=500))])

pipe_rf_clf.fit(X, y)

# Сериал "Уэнсдэй" (отзыв положительный)
pipe_rf_clf.predict(['''
случай результат превосходить ожидание сразу стоить уточнять ждать совсем немногое трейлер не внушать особый доверие обещать сериал дух приключение сабрина приятно ошибаться выход получать незатейливый место интересный история очаровательный главный героиня уэнсдей полно косяк недочет минус находиться плюс деревянный скучный совершенно неубедительный зет роль мортиша великолепный ортег крайне милый несмотря специфический внешность гусман вещь дядя фестер пятиминутный подростковый любовный треугольник потерпеть гораздо интересно следить эволюция взаимоотношение уэнсдей эниды протяжение серия очень трогательный финал последний й серия главный минус сериал становиться отсутствие интрига личина злодей угадывать серия жирный очевидный подсказка прилично смазывать впечатление последний серия просмотр равный оставаться приятный послевкусие память застревать красивый план замысловатый декорация интересный костюм приятный ухо саундтрек аудио визуальный разумеется не особый значение без грамотно прописывать главный героиня центр повествование протяжение серия наблюдать взаимоотношение уэнсдей семья новый знакомый персонаж проходить длинный путь замкнутый эгоистичный социфоб способный самопожертвование дружба превращение верить здорово пусть часть персонаж не раскрывать толком не рассказывать школьный группировка урок школа блин фехтование растениеводство пара сюжетный ветка вообще забросить полпути видимо откладывать сезон час проваливаться атмосфера подростковый фэнтези испытывать эмоция схожий прочтение орден феникс летний возраст стоять
'''])

# Фильм "Криминальное чтиво" (отзыв положительный)
pipe_rf_clf.predict(['''
культовый фильм самый хороший режиссер современность картина расходиться цитата мема мир просмотр не пожалеть потратить очень внимательно вслушиваться диалог дабы улавливать смысл происходить экран очередь стоить отмечать очень талантливо миксовать комедия преступление делать живой беседа главный герой лично гениальность режиссер высмеивать составлять криминальный мир потешаться банальный стереотипный вид общение формальный ситуация бытовой главный герой наблюдать типовой поведение различный обстановка превращать черный юмор огромный плюс кинокартина не очередной бомбежка друг друг очень хороший гангстерский лента философия закладывать буквально фраза поэтому фильм являться хороший жанр показываться нудный длинный большой вероятность лента не похожий типичный криминальный кино подумать подниматься тема мораль верность поиск жизненный смысл криминальный чтиво безусловно картина являться сплошной режиссерский почерк особенно не знакомый творчество данный режиссер шедевр вполне подходить знакомство работа великий мастер криминальный драма кинолента использовать излюбленный прием нижний ракурс мексиканский тупик резюмировать вышесказанный приходить вывод данный картина вовсе не шаблонный фильм очень эстетизация насилие кровь очень интересный смесь юмор ирония кровавый постмодернистский боевик
'''])

# Фильм "Список Шиндлера" (отзыв положительный)
pipe_rf_clf.predict(['''
великий фильм не фильм шедевр мировой кинематограф подобно роман война мир великий произведение оставаться монумент человечество проходить век возможно не памятник жить не смотря ни простой умный предприниматель нужный деньги видеть ужас гитлеровщина свирепый массовый казнь еврей внутренний мир меняться душа понимать виноватый душа говорить помогать вопрос жестокий таки духовно нравственный достойный избранный посмотреть гадость зло твориться духовно нравственный повлиять изменение баланс добро зло великий человеческий натура писать гуманист век фильм показ землянин добро
'''])

# Фильм "Список Шиндлера" (отзыв отрицательный)
pipe_rf_clf.predict(['''
целое трагедия передавать режиссер фильм понятный ясный не благодаря фильм очень хотеться сопереживать персонаж главный герой данный картина выступать промышленник воспринимать простой прагматик являться великодушный не менее исходить необходимость построить производство использовать крайне дешевый рабский рабочий сила еврейский население краков ицхак штерн данный фильм сыграть без лишний слово высоко всякий похвала пожалуй относиться актерский игра не наполнение картина стоить обращать внимание цветовой палитра фильм выдерживать откровенно черно белый тон не менее ряд персонаж подсвечивать яркий краска сторона не совсем понятно обусловливать персонаж выделять главный герой управлять сопереживать некого крайний мера персонаж не находить происходить ужасный фильм передавать допускать прекрасный художественный фильм решать вопрос передача дух художественный план список становиться ясно час просмотр понимать смотреть уставать приходиться наблюдать действо час фильм бункер наблюдать действие течение лента не задумываться хронометраж минута происходить качество вывод следующий не фильм топ судя заслуживать просмотр не фильм получать куча достойный не хватать сюжет динамика сопереживание не помнить случай нацист строить поместье концлагерь очень странный решение учитывать факт описывать уильям ширер указывать факт нацист стремиться привлекать коллаборант наиболее отмораживать нацист ликвидация еврейский цыганский советский народ странный решение держать собака намордник проводить еврейский конвой наоборот стоить давать возможность собака сделать дело достоверно касаться прочий особенность актер играть нацист внушать страх еврей фильм страх поглощать верить картинка очень классный операторский работа звук звуковой оформление очень высокий уровень концовка очень трогательный показывать советский солдат спускать повествование унитаз фильм очень сильно проседать мера повествование причина давать резюме очередной кино война автор не забывать сцена нагадить голова советский не становиться советовать просмотр
'''])

# Фильм "Дьявол носит Prada" (отзыв отрицательный)
film_gs = '''
Еще в детстве, когда я смотрела этот фильм, мне очень понравилась картинка, очень понравились главные героини. Но мне не понравился посыл: стань такой, какой хочет твой мужик и токсичные друзья. Я тогда ещё не знала слово «токсичный», но я остро ощутила, что так жить нельзя. Что с горных вершин она падает в болото, в котором она не сможет быть собой. Миранда реально тянула героиню вверх. А старые друзья были как крабы в банке, которые хотели лишь одного — чтобы она оставалась такой, какой была раньше.

Миранда заставила измениться героиню внешне. Но внутренне девушка осталось той же яркой, целеустремлённой натурой, которой была. Более того, она ещё сильнее открыла в себе эти качества. Миранда не лезла к ней в душу, не заставляла изменить свой характер. Она хотела только одного — качественного выполнения работы. И девушка, выполняя ее, значительно выросла личностно, стала организованной и хваткой, а не безответственной и расхлябанной, как раньше, что замечает и её начальница. Обратно же героиня падает потому, что сценаристы хотели показать: главное — отношение. Как человека, бывший в токсичном окружении много лет, могу сказать: не любые отношения стоят того.

У героини были все шансы построить новые отношения с людьми, подобными ей. Но она испугалась одиночества, разочарования, в которое на время впала Миранда. Ей кажется, что слова, сказанные в горькую минуту, и есть её настоящая жизнь. Она испугалась, что ее ждет такая же жалкая жизнь. На самом деле жизнь Миранды далеко не жалкая. Она в полной мере реализует свой талант. Она может позволить себе быть искренней даже с помощницей и не бояться осуждения. Да, она не пускает незнакомых людей в душу, но в этом и суть! Энди сама точно охарактеризовала ее: «Будь Миранда мужчиной, все бы только и говорили о том, что она мастер своего дела». А ещё у Миранды двое любимых и любящих её дочерей.

Энди не дала себе времени понять, что мир бизнеса не для розовых соплей и сантиментов. Она не дала себе времени узнать новых людей, которые ее окружают, понять, что ими движет. Она поспешила их осудить по меркам домашних посиделок и милых междусобойчиков. Как овечка, привыкнув жить в овечьем стаде, начинает считать прайд львов каким-то жестоким и кровожадным. И будет права по меркам овечьего стада. Но не по меркам хищников. А еще Энди не понимает одну простую вещь: она сама не овечка. Она хищница. И она успешно демонстрирует это на протяжении всего фильма. Вернувшись в овечье стадо, она обращает свою собственную силу против себя. И ей ещё предстоит это узнать.

И конечно, Миранда никакой не дьявол. Она обычный человек, который любит свою семью, хочет самореализации, тщательно выбирает свой ближний круг и помогает своей бывшей помощнице найти новую работу. Как мать, которая прощает непутевого ребенка. И если это дьяволизм, то нам всем не мешало бы поучиться такому дьяволизму.

Мораль ужасна и перечеркивает всё, но фильм как произведение искусства
'''

film_clean_gs = preprocess_ML(film_gs) # применим препроцессинг
film_clean_gs

# Фильм "Дьявол носит Prada" (отзыв отрицательный)
pipe_rf_clf.predict(['''
детство смотреть фильм очень понравиться картинка очень понравиться главный героиня не понравиться посыл становиться мужик токсичный друг не знать слово токсичный остро ощущать жить нельзя горный вершина падать болото не смочь миранда реально тянуть героиня старый друг краб банк оставаться миранда заставлять изменяться героиня внешне внутренне девушка оставаться яркий целеустремленный натура более сильно открывать качество миранда не лезть душа не заставлять изменять характер качественный выполнение работа девушка выполнять значительно вырастать личностный становиться организованный хватка не безответственный расхлябывать замечать начальница обратно героиня падать сценарист показывать главное отношение бывший токсичный окружение не любой отношение стоять героиня шанс построить новый отношение подобный испугаться одиночество разочарование впадать миранда казаться слово горький минута настоящий испугаться ждать жалкий самый дело миранда не жалкий полный мера реализовать талант позволять искренний помощница не бояться осуждение не пускать незнакомый душа энди точно охарактеризовать миранда мужчина говорить мастер дело миранда двое любимый любить дочь энди не давать понимать мир бизнес не розовый сопли сантименты не давать узнавать новый окружать понимать двигать поспешить осуждать мерка домашний посиделки милый междусобойчик овечка привыкать жить овечий стадо начинать считать прайд лев жестокий кровожадный право мерка овечий стадо не мерка хищник энди не понимать простой вещь не овечка хищница успешно демонстрировать протяжение фильм вернуться овечий стадо обращать собственный сила предстоять узнавать миранда никакой не дьявол обычный любить семья самореализация тщательно выбирать ближний круг помогать бывший помощница находить новый работа мать прощать непутевый ребенок дьяволизм не мешать поучиться дьяволизм мораль ужасный перечеркивать фильм произведение искусство
'''])